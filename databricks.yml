# Databricks Asset Bundle Configuration
# Deploy: databricks bundle deploy --target dev

bundle:
  name: genie_enhancer

sync:
  exclude:
    # Virtual environments
    - ".venv"
    - "venv"
    - "ENV"
    - "env"

    # Node modules and frontend build
    - "frontend/node_modules"
    - "frontend/.next"

    # Local storage and runtime data
    - "storage"
    - "output"

    # Git and development
    - ".git"
    - ".databricks"
    - "worktrees"

    # Python bytecode
    - "__pycache__"
    - "*.pyc"
    - "*.pyo"
    - "*.pyd"

    # Environment and secrets
    - ".env"
    - ".env.local"

    # Cache and temporary files
    - "*.log"
    - "*.pid"
    - ".parse_cache.json"

    # IDE and OS
    - ".vscode"
    - ".idea"
    - ".DS_Store"

    # Reference code (not needed for deployment)
    - "reference"

    # Documentation and non-runtime files
    - "docs"
    - "claudedocs"
    - "benchmarks"
    - "config"
    - "schema"
    - "workflows"

# Base resources (can be overridden per target)
resources:
  apps:
    genie_enhancer_app:
      name: genie-enhancer
      description: Genie Space Enhancement Tool - Improves Genie Space accuracy using AI-generated fixes
      permissions:
        - group_name: users
          level: CAN_USE

# Target environments
targets:
  dev:
    mode: development
    default: true
    workspace:
      host: https://krafton-sandbox.cloud.databricks.com/
    resources:
      apps:
        genie_enhancer_app:
          # Override app name with -dev suffix
          name: genie-enhancer-dev
          # Use bundle deployment path
          source_code_path: ${workspace.file_path}/files/
          config:
            env:
              # Override with dev-specific secrets
              - name: DATABRICKS_TOKEN
                value: "{{secrets/genie-enhancement/service-token}}"

              - name: DATABRICKS_HTTP_PATH
                value: "{{secrets/genie-enhancement/sql-warehouse-http-path}}"
