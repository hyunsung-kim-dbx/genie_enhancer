[
  {
    "id": "social_analytics_003",
    "question": "inZOI 게임의 전체 소셜 플랫폼(디스코드, 스팀 리뷰, 스팀 토픽)에서 2025년 8월 18일부터 8월 25일까지 반응이 가장 많은 플랫폼은 무엇인가요?",
    "korean_question": "inZOI 게임의 전체 소셜 플랫폼(디스코드, 스팀 리뷰, 스팀 토픽)에서 2025년 8월 18일부터 8월 25일까지 반응이 가장 많은 플랫폼은 무엇인가요?",
    "expected_sql": "WITH platform_data AS (\n  SELECT \n    'discord' as platform,\n    m.message_id as content_id,\n    m.message as content_text,\n    m.created_at as event_time,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n  GROUP BY m.message_id, m.message, m.created_at\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    CAST(sa.recommendationid AS STRING) as content_id,\n    sa.review as content_text,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    ct.topic_id as content_id,\n    ct.content as content_text,\n    FROM_UNIXTIME(ct.timestamp) as event_time,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url = ct.url) as reaction_count\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= DATE '2025-08-18'\n    AND ct.event_date <= DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n)\nSELECT \n  platform,\n  COUNT(*) as content_count,\n  SUM(reaction_count) as total_reactions,\n  MAX(reaction_count) as max_reactions,\n  MAX(content_text) as sample_content\nFROM platform_data\nWHERE reaction_count > 0\nGROUP BY platform\nORDER BY total_reactions DESC\nLIMIT 10;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_004",
    "question": "inZOI 게임의 디스코드에서 2025년 8월 25일에 가장 핫한 토픽(시간대별 반응이 많은 채널)은 무엇인가요?",
    "korean_question": "inZOI 게임의 디스코드에서 2025년 8월 25일에 가장 핫한 토픽(시간대별 반응이 많은 채널)은 무엇인가요?",
    "expected_sql": "WITH hot_messages AS (\n  SELECT \n    m.message_id,\n    m.created_at,\n    m.channel_id,\n    c.channel_name,\n    COALESCE(SUM(r.count), 0) as reaction_count,\n    DATE_TRUNC('hour', m.created_at) as hour_bucket\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  LEFT JOIN sandbox.agent_poc.channel_list c ON m.channel_id = c.channel_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date = DATE '2025-08-25'\n  GROUP BY m.message_id, m.created_at, m.channel_id, c.channel_name\n),\nchannel_hourly_stats AS (\n  SELECT \n    hour_bucket,\n    channel_name,\n    COUNT(*) as message_count,\n    SUM(reaction_count) as total_reactions,\n    AVG(reaction_count) as avg_reactions,\n    MAX(reaction_count) as max_reactions\n  FROM hot_messages\n  GROUP BY hour_bucket, channel_name\n)\nSELECT \n  hour_bucket,\n  channel_name,\n  message_count,\n  total_reactions,\n  ROUND(avg_reactions, 2) as avg_reactions,\n  max_reactions\nFROM channel_hourly_stats\nORDER BY total_reactions DESC\nLIMIT 10;",
    "category": "social_analytics",
  },
  {
    "id": "social_analytics_006",
    "question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 25일 동안 플랫폼별 콘텐츠 수와 반응 통계는 어떻게 되나요?",
    "korean_question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 25일 동안 플랫폼별 콘텐츠 수와 반응 통계는 어떻게 되나요?",
    "expected_sql": "WITH content_stats AS (\n  SELECT \n    'discord' as platform,\n    COUNT(DISTINCT m.message_id) as content_count,\n    COALESCE(SUM(r.count), 0) as total_reactions,\n    AVG(LENGTH(m.message)) as avg_message_length\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date = DATE '2025-08-25'\n    AND m.message IS NOT NULL\n    AND LENGTH(m.message) > 10\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    COUNT(DISTINCT sa.recommendationid) as content_count,\n    SUM(sa.votes_up) as total_reactions,\n    AVG(LENGTH(sa.review)) as avg_message_length\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date = DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    COUNT(DISTINCT ct.topic_id) as content_count,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url IN (SELECT url FROM sandbox.agent_poc.community_discussions_topics \n                             WHERE app_id = 2456740 \n                             AND event_date = DATE '2025-08-25')) as total_reactions,\n    AVG(LENGTH(ct.content)) as avg_message_length\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date = DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_comment' as platform,\n    COUNT(DISTINCT cc.comment_id) as content_count,\n    0 as total_reactions,\n    AVG(LENGTH(cc.content)) as avg_message_length\n  FROM sandbox.agent_poc.community_discussions_comments cc\n  WHERE cc.app_id = 2456740\n    AND cc.event_date = DATE '2025-08-25'\n    AND cc.content IS NOT NULL\n)\nSELECT \n  platform,\n  content_count,\n  total_reactions,\n  ROUND(avg_message_length, 2) as avg_content_length\nFROM content_stats\nORDER BY content_count DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_009",
    "question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 반응이 많은 콘텐츠(긍정/부정/고참여)의 플랫폼별 통계를 보여주세요",
    "korean_question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 반응이 많은 콘텐츠(긍정/부정/고참여)의 플랫폼별 통계를 보여주세요",
    "expected_sql": "WITH sentiment_data AS (\n  SELECT \n    'discord' as platform,\n    m.message_id as content_id,\n    m.created_at as event_time,\n    COALESCE(SUM(r.count), 0) as reaction_count,\n    'high_engagement' as sentiment_type\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n  GROUP BY m.message_id, m.created_at\n  HAVING COALESCE(SUM(r.count), 0) >= 5\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    CAST(sa.recommendationid AS STRING) as content_id,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count,\n    'positive' as sentiment_type\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.voted_up = true\n    AND sa.votes_up >= 10\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    CAST(sa.recommendationid AS STRING) as content_id,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count,\n    'negative' as sentiment_type\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.voted_up = false\n    AND sa.votes_up >= 10\n)\nSELECT \n  sentiment_type,\n  platform,\n  COUNT(*) as content_count,\n  SUM(reaction_count) as total_reactions,\n  AVG(reaction_count) as avg_reactions,\n  MAX(reaction_count) as max_reactions,\n  MIN(event_time) as earliest_time,\n  MAX(event_time) as latest_time\nFROM sentiment_data\nGROUP BY sentiment_type, platform\nORDER BY sentiment_type, total_reactions DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_010",
    "question": "inZOI 게임의 스팀 부정 리뷰와 디스코드 고반응 메시지에서 2025년 8월 18일부터 8월 25일까지 플랫폼별 부정 동향 통계는 무엇인가요?",
    "korean_question": "inZOI 게임의 스팀 부정 리뷰와 디스코드 고반응 메시지에서 2025년 8월 18일부터 8월 25일까지 플랫폼별 부정 동향 통계는 무엇인가요?",
    "expected_sql": "WITH negative_content AS (\n  SELECT \n    'discord' as platform,\n    m.message_id as content_id,\n    m.created_at as event_time,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n    AND m.message IS NOT NULL\n  GROUP BY m.message_id, m.created_at\n  HAVING COALESCE(SUM(r.count), 0) >= 5\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    CAST(sa.recommendationid AS STRING) as content_id,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.voted_up = false\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    ct.topic_id as content_id,\n    FROM_UNIXTIME(ct.timestamp) as event_time,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url = ct.url) as reaction_count\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= DATE '2025-08-18'\n    AND ct.event_date <= DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n)\nSELECT \n  platform,\n  COUNT(*) as content_count,\n  SUM(reaction_count) as total_reactions,\n  AVG(reaction_count) as avg_reactions,\n  MAX(reaction_count) as max_reactions,\n  MIN(event_time) as earliest_time,\n  MAX(event_time) as latest_time\nFROM negative_content\nGROUP BY platform\nORDER BY total_reactions DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_011",
    "question": "inZOI 게임(app_id: 2456740)의 스팀 리뷰에서 2025년 7월 26일부터 8월 25일까지 부정 리뷰가 급증한 시점과 주요 통계는 무엇인가요?",
    "korean_question": "inZOI 게임(app_id: 2456740)의 스팀 리뷰에서 2025년 7월 26일부터 8월 25일까지 부정 리뷰가 급증한 시점과 주요 통계는 무엇인가요?",
    "expected_sql": "-- event_date 기준으로 일자별 그룹핑\nWITH daily_reviews AS (\n  SELECT \n    sa.event_date as review_date,\n    COUNT(*) as total_reviews,\n    COUNT(CASE WHEN voted_up = false THEN 1 END) as negative_reviews,\n    COUNT(CASE WHEN voted_up = true THEN 1 END) as positive_reviews,\n    ROUND(COUNT(CASE WHEN voted_up = false THEN 1 END) * 100.0 / COUNT(*), 2) as negative_ratio\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-07-26'\n    AND sa.event_date <= DATE '2025-08-25'\n  GROUP BY sa.event_date\n),\nspike_detection AS (\n  SELECT \n    review_date,\n    total_reviews,\n    negative_reviews,\n    positive_reviews,\n    negative_ratio,\n    CASE \n      WHEN LAG(negative_reviews) OVER (ORDER BY review_date) > 0 \n      THEN ROUND((negative_reviews - LAG(negative_reviews) OVER (ORDER BY review_date)) * 100.0 \n                 / LAG(negative_reviews) OVER (ORDER BY review_date), 2)\n      ELSE NULL\n    END as negative_growth_rate\n  FROM daily_reviews\n),\nspike_dates AS (\n  SELECT review_date\n  FROM spike_detection\n  WHERE negative_growth_rate >= 50\n     OR (negative_reviews >= 20 AND negative_ratio >= 40)\n),\nnegative_reviews_detail AS (\n  SELECT \n    sa.event_date as review_date,\n    COUNT(*) as spike_day_negative_count,\n    AVG(sa.votes_up) as avg_votes_up,\n    MAX(sa.votes_up) as max_votes_up\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.voted_up = false\n    AND sa.event_date IN (SELECT review_date FROM spike_dates)\n    AND sa.review IS NOT NULL\n  GROUP BY sa.event_date\n)\nSELECT \n  sd.review_date,\n  sd.total_reviews,\n  sd.negative_reviews,\n  sd.positive_reviews,\n  sd.negative_ratio,\n  sd.negative_growth_rate,\n  nrd.spike_day_negative_count,\n  ROUND(nrd.avg_votes_up, 2) as avg_votes_up,\n  nrd.max_votes_up\nFROM spike_detection sd\nLEFT JOIN negative_reviews_detail nrd ON sd.review_date = nrd.review_date\nWHERE sd.review_date IN (SELECT review_date FROM spike_dates)\nORDER BY sd.review_date DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_014",
    "question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 플랫폼별 콘텐츠와 반응 통계를 비교해주세요",
    "korean_question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 플랫폼별 콘텐츠와 반응 통계를 비교해주세요",
    "expected_sql": "WITH discord_stats AS (\n  SELECT \n    'discord' as platform,\n    COUNT(DISTINCT m.message_id) as content_count,\n    COALESCE(SUM(r.count), 0) as total_reactions,\n    AVG(LENGTH(m.message)) as avg_message_length\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n),\nsteam_stats AS (\n  SELECT \n    'steam_review' as platform,\n    COUNT(DISTINCT sa.recommendationid) as content_count,\n    SUM(sa.votes_up) as total_reactions,\n    AVG(LENGTH(sa.review)) as avg_message_length\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    COUNT(DISTINCT ct.topic_id) as content_count,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url IN (SELECT url FROM sandbox.agent_poc.community_discussions_topics \n                             WHERE app_id = 2456740 \n                             AND event_date >= DATE '2025-08-18'\n                             AND event_date <= DATE '2025-08-25')) as total_reactions,\n    AVG(LENGTH(ct.content)) as avg_message_length\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= DATE '2025-08-18'\n    AND ct.event_date <= DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n)\nSELECT \n  platform,\n  content_count,\n  total_reactions,\n  ROUND(avg_message_length, 2) as avg_content_length,\n  ROUND(total_reactions * 100.0 / SUM(total_reactions) OVER (), 2) as reaction_percentage\nFROM (\n  SELECT * FROM discord_stats\n  UNION ALL\n  SELECT * FROM steam_stats\n) combined_stats\nORDER BY total_reactions DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_016",
    "question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 25일에 시간대별로 어떤 소셜 반응이 일어났는지 보여주세요",
    "korean_question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 25일에 시간대별로 어떤 소셜 반응이 일어났는지 보여주세요",
    "expected_sql": "WITH all_events AS (\n  SELECT \n    'discord' as platform,\n    'message' as event_type,\n    m.message_id as event_id,\n    m.message as content_text,\n    m.created_at as event_time,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date = DATE '2025-08-25'\n  GROUP BY m.message_id, m.message, m.created_at\n  \n  UNION ALL\n  \n  SELECT \n    'steam' as platform,\n    'review' as event_type,\n    CAST(sa.recommendationid AS STRING) as event_id,\n    sa.review as content_text,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date = DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam' as platform,\n    'topic' as event_type,\n    ct.topic_id as event_id,\n    ct.content as content_text,\n    FROM_UNIXTIME(ct.timestamp) as event_time,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url = ct.url) as reaction_count\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date = DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n),\nhourly_summary AS (\n  SELECT \n    DATE_TRUNC('hour', event_time) as hour_bucket,\n    platform,\n    event_type,\n    COUNT(*) as event_count,\n    SUM(reaction_count) as total_reactions,\n    MAX(reaction_count) as max_reactions,\n    MAX(content_text) as top_content\n  FROM all_events\n  GROUP BY DATE_TRUNC('hour', event_time), platform, event_type\n)\nSELECT \n  hour_bucket,\n  platform,\n  event_type,\n  event_count,\n  total_reactions,\n  max_reactions,\n  top_content as sample_content\nFROM hourly_summary\nORDER BY hour_bucket DESC, platform, event_type;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_017",
    "question": "inZOI 게임의 디스코드에서 2025년 8월 25일 14시 전후 1시간 동안 채널별로 무슨 대화가 오갔나요?",
    "korean_question": "inZOI 게임의 디스코드에서 2025년 8월 25일 14시 전후 1시간 동안 채널별로 무슨 대화가 오갔나요?",
    "expected_sql": "WITH discord_conversations AS (\n  SELECT \n    m.message_id,\n    m.created_at,\n    m.channel_id,\n    c.channel_name,\n    m.thread_id,\n    t.thread_title,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  LEFT JOIN sandbox.agent_poc.channel_list c ON m.channel_id = c.channel_id\n  LEFT JOIN sandbox.agent_poc.thread_list t ON m.thread_id = t.thread_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date = DATE '2025-08-25'\n    AND m.created_at >= TIMESTAMP '2025-08-25 14:00:00' - INTERVAL 1 HOUR\n    AND m.created_at <= TIMESTAMP '2025-08-25 14:00:00' + INTERVAL 1 HOUR\n  GROUP BY m.message_id, m.created_at, m.channel_id, c.channel_name, \n           m.thread_id, t.thread_title\n),\nchannel_stats AS (\n  SELECT \n    channel_name,\n    COUNT(*) as message_count,\n    SUM(reaction_count) as total_reactions,\n    AVG(reaction_count) as avg_reactions,\n    MAX(reaction_count) as max_reactions,\n    MIN(created_at) as first_message_time,\n    MAX(created_at) as last_message_time\n  FROM discord_conversations\n  GROUP BY channel_name\n)\nSELECT \n  channel_name,\n  message_count,\n  total_reactions,\n  ROUND(avg_reactions, 2) as avg_reactions,\n  max_reactions,\n  first_message_time,\n  last_message_time\nFROM channel_stats\nORDER BY total_reactions DESC\nLIMIT 10;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_018",
    "question": "inZOI 게임(app_id: 2456740)의 트래픽이 급증한 시점(2025년 7월 26일~8월 25일)에 디스코드와 스팀에서 어떤 소셜 반응이 있었나요?",
    "korean_question": "inZOI 게임(app_id: 2456740)의 트래픽이 급증한 시점(2025년 7월 26일~8월 25일)에 디스코드와 스팀에서 어떤 소셜 반응이 있었나요?",
    "expected_sql": "WITH traffic_data AS (\n  SELECT \n    pt.event_date,\n    pt.app_id,\n    pt.visits,\n    CASE \n      WHEN LAG(pt.visits) OVER (PARTITION BY pt.app_id ORDER BY pt.event_date) > 0 \n      THEN ROUND((pt.visits - LAG(pt.visits) OVER (PARTITION BY pt.app_id ORDER BY pt.event_date)) * 100.0 \n                 / LAG(pt.visits) OVER (PARTITION BY pt.app_id ORDER BY pt.event_date), 2)\n      ELSE NULL\n    END as growth_rate\n  FROM sandbox.agent_poc.partner_traffic pt\n  WHERE pt.app_id = 2456740\n    AND pt.event_date >= DATE '2025-07-26'\n    AND pt.event_date <= DATE '2025-08-25'\n),\ntraffic_spikes AS (\n  SELECT \n    event_date,\n    app_id,\n    visits,\n    growth_rate\n  FROM traffic_data\n  WHERE growth_rate >= 30  -- 급증 기준: 전일 대비 30% 이상 증가\n     OR visits >= (SELECT AVG(visits) * 1.8 FROM traffic_data)  -- 또는 평균의 1.8배 이상\n),\n-- Discord 반응 데이터 (트래픽 스파이크 날짜 범위 내, event_date 기준)\ndiscord_reactions AS (\n  SELECT \n    m.event_date,\n    COUNT(DISTINCT m.message_id) as content_count,\n    COALESCE(SUM(r.count), 0) as total_reactions\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= (SELECT MIN(event_date) - INTERVAL 1 DAY FROM traffic_spikes)\n    AND m.event_date <= (SELECT MAX(event_date) + INTERVAL 1 DAY FROM traffic_spikes)\n  GROUP BY m.event_date\n),\n-- Steam 리뷰 반응 데이터 (event_date 기준)\nsteam_review_reactions AS (\n  SELECT \n    sa.event_date,\n    COUNT(DISTINCT sa.recommendationid) as content_count,\n    SUM(sa.votes_up) as total_reactions\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= (SELECT MIN(event_date) - INTERVAL 1 DAY FROM traffic_spikes)\n    AND sa.event_date <= (SELECT MAX(event_date) + INTERVAL 1 DAY FROM traffic_spikes)\n    AND sa.review IS NOT NULL\n  GROUP BY sa.event_date\n),\n-- Steam 토픽 코멘트 수 계산 (event_date 기준)\nsteam_topic_comments AS (\n  SELECT \n    ct.event_date,\n    COUNT(DISTINCT cc.comment_id) as total_reactions\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  INNER JOIN sandbox.agent_poc.community_discussions_comments cc \n    ON cc.topic_url = ct.url\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= (SELECT MIN(event_date) - INTERVAL 1 DAY FROM traffic_spikes)\n    AND ct.event_date <= (SELECT MAX(event_date) + INTERVAL 1 DAY FROM traffic_spikes)\n  GROUP BY ct.event_date\n),\n-- Steam 토픽 반응 데이터 (event_date 기준)\nsteam_topic_reactions AS (\n  SELECT \n    ct.event_date,\n    COUNT(DISTINCT ct.topic_id) as content_count,\n    COALESCE(stc.total_reactions, 0) as total_reactions\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  LEFT JOIN steam_topic_comments stc \n    ON ct.event_date = stc.event_date\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= (SELECT MIN(event_date) - INTERVAL 1 DAY FROM traffic_spikes)\n    AND ct.event_date <= (SELECT MAX(event_date) + INTERVAL 1 DAY FROM traffic_spikes)\n    AND ct.content IS NOT NULL\n  GROUP BY ct.event_date, stc.total_reactions\n),\n-- 플랫폼별 소셜 반응 통합\nsocial_reactions AS (\n  SELECT \n    'discord' as platform,\n    event_date,\n    content_count,\n    total_reactions\n  FROM discord_reactions\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    event_date,\n    content_count,\n    total_reactions\n  FROM steam_review_reactions\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    event_date,\n    content_count,\n    total_reactions\n  FROM steam_topic_reactions\n)\n-- 트래픽 스파이크와 소셜 반응 매칭 (날짜 범위 조인)\nSELECT \n  ts.event_date as traffic_spike_date,\n  ts.visits as traffic_visits,\n  ts.growth_rate as traffic_growth_rate,\n  sr.platform,\n  SUM(sr.content_count) as total_content,\n  SUM(sr.total_reactions) as total_engagement\nFROM traffic_spikes ts\nLEFT JOIN social_reactions sr \n  ON sr.event_date BETWEEN ts.event_date - INTERVAL 1 DAY \n                       AND ts.event_date + INTERVAL 1 DAY\nGROUP BY ts.event_date, ts.visits, ts.growth_rate, sr.platform\nORDER BY ts.event_date DESC, sr.platform;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_022",
    "question": "inZOI 게임(app_id: 2456740)의 지역별(region 단위) 위시리스트와 판매량 통계를 2025년 7월 26일부터 8월 25일까지 보여주세요",
    "korean_question": "inZOI 게임(app_id: 2456740)의 지역별(region 단위) 위시리스트와 판매량 통계를 2025년 7월 26일부터 8월 25일까지 보여주세요",
    "expected_sql": "-- 지역별 위시리스트 및 판매량 데이터 (리뷰 데이터는 성능상 별도 쿼리 권장)\nSELECT \n  prc.scope,\n  prc.name as region_name,\n  COUNT(DISTINCT prc.event_date) as days_tracked,\n  SUM(prc.wishlists) as total_wishlists,\n  SUM(prc.units) as total_sales,\n  ROUND(AVG(prc.wishlists), 2) as avg_daily_wishlists,\n  ROUND(AVG(prc.units), 2) as avg_daily_sales,\n  MIN(prc.event_date) as period_start,\n  MAX(prc.event_date) as period_end\nFROM sandbox.agent_poc.partner_regions_and_countries prc\nWHERE prc.app_id = 2456740\n  AND prc.scope = 'region'\n  AND prc.event_date >= DATE '2025-07-26'\n  AND prc.event_date <= DATE '2025-08-25'\nGROUP BY prc.scope, prc.name\nORDER BY total_sales DESC\nLIMIT 10;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_024",
    "question": "inZOI 게임의 마케팅 캠페인(2025년 8월 25일~9월 1일) 전후로 디스코드와 스팀의 소셜 반응 변화를 비교해주세요",
    "korean_question": "inZOI 게임의 마케팅 캠페인(2025년 8월 25일~9월 1일) 전후로 디스코드와 스팀의 소셜 반응 변화를 비교해주세요",
    "expected_sql": "WITH discord_activity AS (\n  SELECT \n    CASE \n      WHEN m.event_date < DATE '2025-08-25' THEN 'before'\n      WHEN m.event_date BETWEEN DATE '2025-08-25' AND DATE '2025-09-01' THEN 'during'\n      ELSE 'after'\n    END as period,\n    COUNT(DISTINCT m.message_id) as message_count,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date BETWEEN DATE '2025-08-18'\n                          AND DATE '2025-09-08'\n  GROUP BY \n    CASE \n      WHEN m.event_date < DATE '2025-08-25' THEN 'before'\n      WHEN m.event_date BETWEEN DATE '2025-08-25' AND DATE '2025-09-01' THEN 'during'\n      ELSE 'after'\n    END\n),\nsteam_activity AS (\n  SELECT \n    CASE \n      WHEN sa.event_date < DATE '2025-08-25' THEN 'before'\n      WHEN sa.event_date BETWEEN DATE '2025-08-25' AND DATE '2025-09-01' THEN 'during'\n      ELSE 'after'\n    END as period,\n    COUNT(DISTINCT sa.recommendationid) as review_count,\n    SUM(sa.votes_up) as total_votes_up\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date BETWEEN DATE '2025-08-18'\n                           AND DATE '2025-09-08'\n    AND sa.review IS NOT NULL\n  GROUP BY \n    CASE \n      WHEN sa.event_date < DATE '2025-08-25' THEN 'before'\n      WHEN sa.event_date BETWEEN DATE '2025-08-25' AND DATE '2025-09-01' THEN 'during'\n      ELSE 'after'\n    END\n),\ncomparison_summary AS (\n  SELECT \n    'discord' as platform,\n    period,\n    SUM(message_count) as activity_count,\n    SUM(reaction_count) as engagement_count\n  FROM discord_activity\n  GROUP BY period\n  \n  UNION ALL\n  \n  SELECT \n    'steam' as platform,\n    period,\n    SUM(review_count) as activity_count,\n    SUM(total_votes_up) as engagement_count\n  FROM steam_activity\n  GROUP BY period\n)\nSELECT \n  platform,\n  period,\n  activity_count,\n  engagement_count\nFROM comparison_summary\nORDER BY platform, \n  CASE period WHEN 'before' THEN 1 WHEN 'during' THEN 2 ELSE 3 END;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_027",
    "question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 25일 하루 동안 플랫폼별 주요 이슈와 통계를 요약해주세요",
    "korean_question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 25일 하루 동안 플랫폼별 주요 이슈와 통계를 요약해주세요",
    "expected_sql": "WITH today_events AS (\n  SELECT \n    'discord' as platform,\n    m.message_id as content_id,\n    m.created_at as event_time,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date = DATE '2025-08-25'\n  GROUP BY m.message_id, m.created_at\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    CAST(sa.recommendationid AS STRING) as content_id,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date = DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    ct.topic_id as content_id,\n    FROM_UNIXTIME(ct.timestamp) as event_time,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url = ct.url) as reaction_count\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date = DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n),\nplatform_summary AS (\n  SELECT \n    platform,\n    COUNT(DISTINCT content_id) as total_content,\n    SUM(reaction_count) as total_reactions,\n    AVG(reaction_count) as avg_reactions,\n    MAX(reaction_count) as max_reactions,\n    MIN(event_time) as earliest_time,\n    MAX(event_time) as latest_time\n  FROM today_events\n  GROUP BY platform\n)\nSELECT \n  platform,\n  total_content,\n  total_reactions,\n  ROUND(avg_reactions, 2) as avg_reactions,\n  max_reactions,\n  earliest_time,\n  latest_time\nFROM platform_summary\nORDER BY total_reactions DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_028",
    "question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 이번 주 주요 소셜 반응을 플랫폼별로 요약해주세요",
    "korean_question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 이번 주 주요 소셜 반응을 플랫폼별로 요약해주세요",
    "expected_sql": "WITH discord_weekly AS (\n  SELECT \n    'discord' as platform,\n    COUNT(DISTINCT m.message_id) as total_messages,\n    COALESCE(SUM(r.count), 0) as total_reactions\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n),\nsteam_weekly AS (\n  SELECT \n    'steam' as platform,\n    COUNT(DISTINCT sa.recommendationid) as total_reviews,\n    SUM(sa.votes_up) as total_votes_up\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n)\nSELECT \n  platform,\n  total_messages as activity_count,\n  total_reactions as engagement_count\nFROM discord_weekly\n\nUNION ALL\n\nSELECT \n  platform,\n  total_reviews as activity_count,\n  total_votes_up as engagement_count\nFROM steam_weekly\nORDER BY platform;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_029",
    "question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 주요 반응을 통합해서 요약해주세요 (긍정/부정 비율 포함)",
    "korean_question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 주요 반응을 통합해서 요약해주세요 (긍정/부정 비율 포함)",
    "expected_sql": "WITH integrated_data AS (\n  SELECT \n    'discord' as platform,\n    m.message_id as content_id,\n    m.created_at as event_time,\n    COALESCE(SUM(r.count), 0) as reaction_count,\n    NULL as sentiment\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n  GROUP BY m.message_id, m.created_at\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    CAST(sa.recommendationid AS STRING) as content_id,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count,\n    CASE WHEN sa.voted_up = true THEN 'positive' ELSE 'negative' END as sentiment\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    ct.topic_id as content_id,\n    FROM_UNIXTIME(ct.timestamp) as event_time,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url = ct.url) as reaction_count,\n    NULL as sentiment\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= DATE '2025-08-18'\n    AND ct.event_date <= DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n),\nplatform_stats AS (\n  SELECT \n    platform,\n    COUNT(DISTINCT content_id) as total_content,\n    SUM(reaction_count) as total_reactions,\n    AVG(reaction_count) as avg_reactions,\n    MAX(reaction_count) as max_reactions,\n    COUNT(CASE WHEN sentiment = 'positive' THEN 1 END) as positive_count,\n    COUNT(CASE WHEN sentiment = 'negative' THEN 1 END) as negative_count\n  FROM integrated_data\n  GROUP BY platform\n),\noverall_stats AS (\n  SELECT \n    COUNT(DISTINCT content_id) as total_content_all,\n    SUM(reaction_count) as total_reactions_all,\n    COUNT(CASE WHEN sentiment = 'positive' THEN 1 END) as total_positive,\n    COUNT(CASE WHEN sentiment = 'negative' THEN 1 END) as total_negative,\n    ROUND(COUNT(CASE WHEN sentiment = 'positive' THEN 1 END) * 100.0 / \n          NULLIF(COUNT(CASE WHEN sentiment IN ('positive', 'negative') THEN 1 END), 0), 2) as positive_ratio\n  FROM integrated_data\n)\nSELECT \n  '=== 통합 소셜 반응 통계 ===' as section,\n  CAST(total_content_all AS STRING) || '개 콘텐츠, ' || \n  CAST(total_reactions_all AS STRING) || '개 반응, ' ||\n  CAST(COALESCE(positive_ratio, 0) AS STRING) || '% 긍정 (스팀 리뷰 기준)' as detail\nFROM overall_stats\n\nUNION ALL\n\nSELECT \n  '플랫폼별 통계' as section,\n  platform || ': ' || total_content || '개 콘텐츠, ' || total_reactions || '개 반응, ' ||\n  COALESCE(CAST(positive_count AS STRING), 'N/A') || '개 긍정, ' ||\n  COALESCE(CAST(negative_count AS STRING), 'N/A') || '개 부정' as detail\nFROM platform_stats\nORDER BY total_reactions DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "kpi_001",
    "question": "inZOI 게임의 디스코드에서 2025년 7월 26일부터 8월 25일까지 리액션이 가장 많은 메시지 20개는 무엇인가요?",
    "korean_question": "inZOI 게임의 디스코드에서 2025년 7월 26일부터 8월 25일까지 리액션이 가장 많은 메시지 20개는 무엇인가요?",
    "expected_sql": "SELECT \n  m.message_id,\n  m.message,\n  m.created_at,\n  c.channel_name,\n  COALESCE(SUM(r.count), 0) as reaction_count,\n  COUNT(DISTINCT r.emoji_name) as unique_emojis,\n  array_join(collect_set(r.emoji_name), ', ') as emoji_list\nFROM sandbox.agent_poc.message m\nLEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\nLEFT JOIN sandbox.agent_poc.channel_list c ON m.channel_id = c.channel_id\nWHERE m.game_code = 'inzoi'\n  AND m.event_date >= DATE '2025-07-26'\n  AND m.event_date <= DATE '2025-08-25'\nGROUP BY m.message_id, m.message, m.created_at, c.channel_name\nHAVING COALESCE(SUM(r.count), 0) > 0\nORDER BY reaction_count DESC\nLIMIT 20;",
    "category": "kpi",
    "difficulty": "medium"
  },
  {
    "id": "kpi_002",
    "question": "inZOI 게임(app_id: 2456740)의 스팀 리뷰에서 2025년 7월 26일부터 8월 25일까지 추천 수가 높은 리뷰 20개는 무엇인가요?",
    "korean_question": "inZOI 게임(app_id: 2456740)의 스팀 리뷰에서 2025년 7월 26일부터 8월 25일까지 추천 수가 높은 리뷰 20개는 무엇인가요?",
    "expected_sql": "SELECT \n  sa.recommendationid,\n  sa.review,\n  FROM_UNIXTIME(sa.timestamp_created) as created_at,\n  sa.votes_up,\n  sa.votes_funny,\n  sa.weighted_vote_score,\n  sa.voted_up,\n  sa.comment_count\nFROM sandbox.agent_poc.store_appreviews sa\nWHERE sa.app_id = 2456740\n  AND sa.event_date >= DATE '2025-07-26'\n  AND sa.event_date <= DATE '2025-08-25'\nORDER BY sa.votes_up DESC, sa.weighted_vote_score DESC\nLIMIT 20;",
    "category": "kpi",
    "difficulty": "medium"
  },
  {
    "id": "kpi_005",
    "question": "inZOI 게임(app_id: 2456740)의 스팀 커뮤니티에서 2025년 7월 26일부터 8월 25일까지 댓글이 많이 달린 토픽 20개는 무엇인가요?",
    "korean_question": "inZOI 게임(app_id: 2456740)의 스팀 커뮤니티에서 2025년 7월 26일부터 8월 25일까지 댓글이 많이 달린 토픽 20개는 무엇인가요?",
    "expected_sql": "SELECT \n  ct.topic_id,\n  ct.title as topic_title,\n  FROM_UNIXTIME(ct.timestamp) as created_at,\n  ct.subforum,\n  COUNT(DISTINCT cc.comment_id) as comment_count,\n  COUNT(DISTINCT cc.author) as unique_commenters,\n  MAX(FROM_UNIXTIME(cc.timestamp)) as last_comment_time\nFROM sandbox.agent_poc.community_discussions_topics ct\nLEFT JOIN sandbox.agent_poc.community_discussions_comments cc \n  ON ct.url = cc.topic_url\nWHERE ct.app_id = 2456740\n  AND ct.event_date >= DATE '2025-07-26'\n  AND ct.event_date <= DATE '2025-08-25'\n  AND FROM_UNIXTIME(ct.timestamp) >= TIMESTAMP '2025-07-26 00:00:00'\n  AND FROM_UNIXTIME(ct.timestamp) <= TIMESTAMP '2025-08-25 23:59:59'\n  AND (cc.comment_id IS NULL OR cc.is_deleted = false)\nGROUP BY ct.topic_id, ct.title, ct.timestamp, ct.subforum\nHAVING COUNT(DISTINCT cc.comment_id) > 0\nORDER BY comment_count DESC\nLIMIT 20;",
    "category": "kpi",
    "difficulty": "medium"
  },
  {
    "id": "kpi_007",
    "question": "inZOI 게임의 디스코드에서 2025년 7월 26일부터 8월 25일까지 가장 활발한 채널 20개는 어디인가요?",
    "korean_question": "inZOI 게임의 디스코드에서 2025년 7월 26일부터 8월 25일까지 가장 활발한 채널 20개는 어디인가요?",
    "expected_sql": "SELECT \n  c.channel_id,\n  c.channel_name,\n  c.guild_id,\n  COUNT(DISTINCT m.message_id) as message_count,\n  COUNT(DISTINCT m.author_id) as unique_authors,\n  COALESCE(SUM(r.count), 0) as reaction_count,\n  COUNT(DISTINCT r.emoji_name) as unique_reactors,\n  COUNT(DISTINCT m.message_id) + COALESCE(SUM(r.count), 0) * 0.5 as activity_score,\n  MIN(m.created_at) as first_message_time,\n  MAX(m.created_at) as last_message_time\nFROM sandbox.agent_poc.channel_list c\nINNER JOIN sandbox.agent_poc.message m ON c.channel_id = m.channel_id\nLEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\nWHERE c.game_code = 'inzoi'\n  AND m.event_date >= DATE '2025-07-26'\n  AND m.event_date <= DATE '2025-08-25'\nGROUP BY c.channel_id, c.channel_name, c.guild_id\nORDER BY activity_score DESC\nLIMIT 20;",
    "category": "kpi",
    "difficulty": "medium"
  },
  {
    "id": "kpi_008",
    "question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 시간대별로 언급량이 가장 많은 시간은 언제인가요?",
    "korean_question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 시간대별로 언급량이 가장 많은 시간은 언제인가요?",
    "expected_sql": "WITH hourly_mentions AS (\n  SELECT \n    HOUR(m.created_at) as hour_of_day,\n    DATE_TRUNC('hour', m.created_at) as hour_bucket,\n    COUNT(DISTINCT m.message_id) as mention_count,\n    COUNT(DISTINCT m.author_id) as unique_authors,\n    'discord' as platform\n  FROM sandbox.agent_poc.message m\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n  AND m.event_date <= DATE '2025-08-25'\n  GROUP BY HOUR(m.created_at), DATE_TRUNC('hour', m.created_at)\n  \n  UNION ALL\n  \n  SELECT \n    HOUR(FROM_UNIXTIME(sa.timestamp_created)) as hour_of_day,\n    DATE_TRUNC('hour', FROM_UNIXTIME(sa.timestamp_created)) as hour_bucket,\n    COUNT(DISTINCT sa.recommendationid) as mention_count,\n    NULL as unique_authors,\n    'steam_review' as platform\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n  AND sa.event_date <= DATE '2025-08-25'\n  GROUP BY HOUR(FROM_UNIXTIME(sa.timestamp_created)), \n           DATE_TRUNC('hour', FROM_UNIXTIME(sa.timestamp_created))\n  \n  UNION ALL\n  \n  SELECT \n    HOUR(FROM_UNIXTIME(ct.timestamp)) as hour_of_day,\n    DATE_TRUNC('hour', FROM_UNIXTIME(ct.timestamp)) as hour_bucket,\n    COUNT(DISTINCT ct.topic_id) as mention_count,\n    COUNT(DISTINCT ct.author) as unique_authors,\n    'steam_topic' as platform\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= DATE '2025-08-18'\n  AND ct.event_date <= DATE '2025-08-25'\n  GROUP BY HOUR(FROM_UNIXTIME(ct.timestamp)), \n           DATE_TRUNC('hour', FROM_UNIXTIME(ct.timestamp))\n)\nSELECT \n  hour_of_day,\n  SUM(mention_count) as total_mentions,\n  SUM(COALESCE(unique_authors, 0)) as total_unique_authors,\n  COUNT(DISTINCT platform) as platform_count,\n  array_join(collect_set(platform), \\', \\') as platforms,\n  ROUND(AVG(mention_count), 2) as avg_mentions_per_hour\nFROM hourly_mentions\nGROUP BY hour_of_day\nORDER BY total_mentions DESC;",
    "category": "kpi",
    "difficulty": "medium"
  },
  {
    "id": "kpi_012",
    "question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 긍정/부정 비율은 어떻게 다른가요?",
    "korean_question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 긍정/부정 비율은 어떻게 다른가요?",
    "expected_sql": "WITH discord_stats AS (\n  SELECT \n    COUNT(DISTINCT m.message_id) as message_count,\n    COUNT(DISTINCT m.author_id) as unique_authors,\n    COALESCE(SUM(r.count), 0) as total_reactions\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n  AND m.event_date <= DATE '2025-08-25'\n    AND m.message IS NOT NULL\n    AND LENGTH(m.message) > 5\n),\nsteam_sentiment AS (\n  SELECT \n    CASE \n      WHEN sa.voted_up = true THEN 'positive'\n      WHEN sa.voted_up = false THEN 'negative'\n    END as sentiment,\n    COUNT(DISTINCT sa.recommendationid) as review_count,\n    SUM(sa.votes_up) as total_votes_up\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n  AND sa.event_date <= DATE '2025-08-25'\n  GROUP BY sa.voted_up\n),\nsteam_summary AS (\n  SELECT \n    sentiment,\n    review_count,\n    total_votes_up,\n    ROUND(review_count * 100.0 / SUM(review_count) OVER (), 2) as percentage\n  FROM steam_sentiment\n)\nSELECT \n  'discord' as platform,\n  0 as positive_ratio,\n  0 as negative_ratio,\n  ds.message_count as total_count,\n  ds.total_reactions\nFROM discord_stats ds\n\nUNION ALL\n\nSELECT \n  'steam' as platform,\n  COALESCE(SUM(CASE WHEN sentiment = 'positive' THEN percentage END), 0) as positive_ratio,\n  COALESCE(SUM(CASE WHEN sentiment = 'negative' THEN percentage END), 0) as negative_ratio,\n  SUM(review_count) as total_count,\n  SUM(total_votes_up) as total_reactions\nFROM steam_summary\nGROUP BY platform\nORDER BY platform;",
    "category": "kpi",
    "difficulty": "medium"
  },
  {
    "id": "kpi_013",
    "question": "inZOI(app_id: 2456740)와 Dinkum(app_id: 1062520) 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 소셜 반응을 비교해주세요",
    "korean_question": "inZOI(app_id: 2456740)와 Dinkum(app_id: 1062520) 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 소셜 반응을 비교해주세요",
    "expected_sql": "-- inzoi (2456740), dko/Dinkum (1062520) 두 게임 비교\nWITH game_info AS (\n  SELECT 'inZOI' as game_name, 'inzoi' as game_code, 2456740 as app_id\n  UNION ALL\n  SELECT 'Dinkum' as game_name, 'dko' as game_code, 1062520 as app_id\n),\ndiscord_activity AS (\n  SELECT \n    m.game_code,\n    COUNT(DISTINCT m.message_id) as message_count,\n    COALESCE(SUM(r.count), 0) as reaction_count,\n    COUNT(DISTINCT m.author_id) as unique_authors,\n    COUNT(DISTINCT m.channel_id) as active_channels\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code IN ('inzoi', 'dko')\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n  GROUP BY m.game_code\n),\nsteam_activity AS (\n  SELECT \n    sa.app_id,\n    COUNT(DISTINCT sa.recommendationid) as review_count,\n    SUM(sa.votes_up) as total_votes_up,\n    AVG(sa.votes_up) as avg_votes_up,\n    COUNT(DISTINCT CASE WHEN sa.voted_up = true THEN sa.recommendationid END) as positive_reviews,\n    COUNT(DISTINCT CASE WHEN sa.voted_up = false THEN sa.recommendationid END) as negative_reviews\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id IN (2456740, 1062520)\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n  GROUP BY sa.app_id\n)\nSELECT \n  gi.game_name,\n  COALESCE(d.message_count, 0) as discord_messages,\n  COALESCE(d.reaction_count, 0) as discord_reactions,\n  COALESCE(d.unique_authors, 0) as discord_authors,\n  COALESCE(d.active_channels, 0) as discord_channels,\n  COALESCE(s.review_count, 0) as steam_reviews,\n  COALESCE(s.total_votes_up, 0) as steam_votes_up,\n  ROUND(COALESCE(s.avg_votes_up, 0), 2) as steam_avg_votes,\n  COALESCE(s.positive_reviews, 0) as steam_positive,\n  COALESCE(s.negative_reviews, 0) as steam_negative,\n  COALESCE(d.message_count, 0) + COALESCE(s.review_count, 0) as total_content,\n  COALESCE(d.reaction_count, 0) + COALESCE(s.total_votes_up, 0) as total_engagement,\n  CASE \n    WHEN COALESCE(s.review_count, 0) > 0 \n    THEN ROUND(COALESCE(s.positive_reviews, 0) * 100.0 / s.review_count, 2)\n    ELSE NULL\n  END as positive_ratio\nFROM game_info gi\nLEFT JOIN discord_activity d ON gi.game_code = d.game_code\nLEFT JOIN steam_activity s ON gi.app_id = s.app_id\nORDER BY total_engagement DESC;",
    "category": "kpi",
    "difficulty": "medium"
  },
  {
    "id": "kpi_015",
    "question": "inZOI 게임의 이벤트(2025년 8월 25일~9월 1일) 전후로 디스코드와 스팀의 소셜 반응 변화는 어떻게 되나요?",
    "korean_question": "inZOI 게임의 이벤트(2025년 8월 25일~9월 1일) 전후로 디스코드와 스팀의 소셜 반응 변화는 어떻게 되나요?",
    "expected_sql": "WITH discord_activity AS (\n  SELECT \n    CASE \n      WHEN m.event_date < DATE '2025-08-25' THEN 'before'\n      WHEN m.event_date BETWEEN DATE '2025-08-25' AND DATE '2025-09-01' THEN 'during'\n      ELSE 'after'\n    END as period,\n    COUNT(DISTINCT m.message_id) as message_count,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date BETWEEN DATE '2025-08-18'\n                          AND DATE '2025-09-08'\n  GROUP BY \n    CASE \n      WHEN m.event_date < DATE '2025-08-25' THEN 'before'\n      WHEN m.event_date BETWEEN DATE '2025-08-25' AND DATE '2025-09-01' THEN 'during'\n      ELSE 'after'\n    END\n),\nsteam_activity AS (\n  SELECT \n    CASE \n      WHEN sa.event_date < DATE '2025-08-25' THEN 'before'\n      WHEN sa.event_date BETWEEN DATE '2025-08-25' AND DATE '2025-09-01' THEN 'during'\n      ELSE 'after'\n    END as period,\n    COUNT(DISTINCT sa.recommendationid) as review_count,\n    SUM(sa.votes_up) as total_votes_up\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date BETWEEN DATE '2025-08-18'\n                           AND DATE '2025-09-08'\n  GROUP BY \n    CASE \n      WHEN sa.event_date < DATE '2025-08-25' THEN 'before'\n      WHEN sa.event_date BETWEEN DATE '2025-08-25' AND DATE '2025-09-01' THEN 'during'\n      ELSE 'after'\n    END\n),\ncomparison AS (\n  SELECT \n    'discord' as platform,\n    period,\n    message_count,\n    reaction_count\n  FROM discord_activity\n  \n  UNION ALL\n  \n  SELECT \n    'steam' as platform,\n    period,\n    review_count as message_count,\n    total_votes_up as reaction_count\n  FROM steam_activity\n)\nSELECT \n  platform,\n  period,\n  message_count,\n  reaction_count\nFROM comparison\nORDER BY platform, \n  CASE period WHEN 'before' THEN 1 WHEN 'during' THEN 2 ELSE 3 END;",
    "category": "kpi",
    "difficulty": "medium"
  },
  {
    "id": "kpi_019",
    "question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 주간 트렌드에서 주요 변화는 무엇인가요?",
    "korean_question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 주간 트렌드에서 주요 변화는 무엇인가요?",
    "expected_sql": "WITH weekly_activity AS (\n  SELECT \n    DATE_TRUNC('week', m.created_at) as week_start,\n    COUNT(DISTINCT m.message_id) as message_count,\n    COALESCE(SUM(r.count), 0) as reaction_count,\n    'discord' as platform\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n  GROUP BY DATE_TRUNC('week', m.created_at)\n  \n  UNION ALL\n  \n  SELECT \n    DATE_TRUNC('week', FROM_UNIXTIME(sa.timestamp_created)) as week_start,\n    COUNT(DISTINCT sa.recommendationid) as message_count,\n    SUM(sa.votes_up) as reaction_count,\n    'steam' as platform\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n  GROUP BY DATE_TRUNC('week', FROM_UNIXTIME(sa.timestamp_created))\n),\nweekly_summary AS (\n  SELECT \n    week_start,\n    platform,\n    SUM(message_count) as total_messages,\n    SUM(reaction_count) as total_reactions\n  FROM weekly_activity\n  GROUP BY week_start, platform\n),\ntrend_analysis AS (\n  SELECT \n    week_start,\n    platform,\n    total_messages,\n    total_reactions,\n    LAG(total_messages) OVER (PARTITION BY platform ORDER BY week_start) as prev_messages,\n    LAG(total_reactions) OVER (PARTITION BY platform ORDER BY week_start) as prev_reactions,\n    CASE \n      WHEN LAG(total_messages) OVER (PARTITION BY platform ORDER BY week_start) > 0\n      THEN ROUND((total_messages - LAG(total_messages) OVER (PARTITION BY platform ORDER BY week_start)) * 100.0 \n                 / LAG(total_messages) OVER (PARTITION BY platform ORDER BY week_start), 2)\n      ELSE NULL\n    END as message_change_rate,\n    CASE \n      WHEN LAG(total_reactions) OVER (PARTITION BY platform ORDER BY week_start) > 0\n      THEN ROUND((total_reactions - LAG(total_reactions) OVER (PARTITION BY platform ORDER BY week_start)) * 100.0 \n                 / LAG(total_reactions) OVER (PARTITION BY platform ORDER BY week_start), 2)\n      ELSE NULL\n    END as reaction_change_rate\n  FROM weekly_summary\n)\nSELECT \n  week_start,\n  platform,\n  total_messages,\n  total_reactions,\n  prev_messages,\n  prev_reactions,\n  message_change_rate,\n  reaction_change_rate,\n  CASE \n    WHEN ABS(message_change_rate) > 30 THEN '큰 변화'\n    WHEN ABS(message_change_rate) > 10 THEN '중간 변화'\n    ELSE '작은 변화'\n  END as change_magnitude\nFROM trend_analysis\nORDER BY week_start DESC, platform;",
    "category": "kpi",
    "difficulty": "medium"
  },
  {
    "id": "kpi_020",
    "question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 최근 일주일 동안 소셜 반응의 주요 변화는 무엇인가요?",
    "korean_question": "inZOI 게임의 디스코드와 스팀에서 2025년 8월 18일부터 8월 25일까지 최근 일주일 동안 소셜 반응의 주요 변화는 무엇인가요?",
    "expected_sql": "WITH daily_activity AS (\n  SELECT \n    m.event_date as activity_date,\n    COUNT(DISTINCT m.message_id) as message_count,\n    COALESCE(SUM(r.count), 0) as reaction_count,\n    'discord' as platform\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n  GROUP BY m.event_date\n  \n  UNION ALL\n  \n  SELECT \n    sa.event_date as activity_date,\n    COUNT(DISTINCT sa.recommendationid) as message_count,\n    SUM(sa.votes_up) as reaction_count,\n    'steam' as platform\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n  GROUP BY sa.event_date\n),\ndaily_summary AS (\n  SELECT \n    activity_date,\n    SUM(message_count) as total_messages,\n    SUM(reaction_count) as total_reactions,\n    COUNT(DISTINCT platform) as platform_count\n  FROM daily_activity\n  GROUP BY activity_date\n),\nchange_analysis AS (\n  SELECT \n    activity_date,\n    total_messages,\n    total_reactions,\n    LAG(total_messages) OVER (ORDER BY activity_date) as prev_messages,\n    LAG(total_reactions) OVER (ORDER BY activity_date) as prev_reactions,\n    CASE \n      WHEN LAG(total_messages) OVER (ORDER BY activity_date) > 0\n      THEN ROUND((total_messages - LAG(total_messages) OVER (ORDER BY activity_date)) * 100.0 \n                 / LAG(total_messages) OVER (ORDER BY activity_date), 2)\n      ELSE NULL\n    END as message_change_rate,\n    CASE \n      WHEN LAG(total_reactions) OVER (ORDER BY activity_date) > 0\n      THEN ROUND((total_reactions - LAG(total_reactions) OVER (ORDER BY activity_date)) * 100.0 \n                 / LAG(total_reactions) OVER (ORDER BY activity_date), 2)\n      ELSE NULL\n    END as reaction_change_rate\n  FROM daily_summary\n)\nSELECT \n  activity_date,\n  total_messages,\n  total_reactions,\n  prev_messages,\n  prev_reactions,\n  message_change_rate,\n  reaction_change_rate,\n  CASE \n    WHEN message_change_rate > 20 THEN '급증'\n    WHEN message_change_rate > 5 THEN '증가'\n    WHEN message_change_rate < -20 THEN '급감'\n    WHEN message_change_rate < -5 THEN '감소'\n    ELSE '안정'\n  END as trend_direction\nFROM change_analysis\nORDER BY activity_date DESC;",
    "category": "kpi",
    "difficulty": "medium"
  },
  {
    "id": "kpi_021",
    "question": "inZOI 게임(app_id: 2456740)의 국가별로 2025년 7월 26일부터 8월 25일까지 스팀 리뷰 반응 속도와 위시리스트/판매량 통계는 어떻게 되나요?",
    "korean_question": "inZOI 게임(app_id: 2456740)의 국가별로 2025년 7월 26일부터 8월 25일까지 스팀 리뷰 반응 속도와 위시리스트/판매량 통계는 어떻게 되나요?",
    "expected_sql": "-- event_date 기준으로 국가별 리뷰 데이터 집계\nWITH country_reviews AS (\n  SELECT \n    prc.name as country_name,\n    sa.recommendationid,\n    FROM_UNIXTIME(sa.timestamp_created) as review_time,\n    sa.event_date as review_date,\n    HOUR(FROM_UNIXTIME(sa.timestamp_created)) as review_hour,\n    sa.voted_up,\n    sa.votes_up,\n    DATEDIFF(hour, TIMESTAMP '2025-07-28 00:00:00', FROM_UNIXTIME(sa.timestamp_created)) as hours_after_event\n  FROM sandbox.agent_poc.partner_regions_and_countries prc\n  INNER JOIN sandbox.agent_poc.store_appreviews sa \n    ON CAST(prc.app_id AS BIGINT) = sa.app_id\n    AND sa.event_date = prc.event_date\n  WHERE prc.app_id = 2456740\n    AND prc.scope = 'country'\n    AND sa.event_date >= DATE '2025-07-26'\n    AND sa.event_date <= DATE '2025-08-25'\n),\ncountry_wishlist AS (\n  SELECT \n    prc.name as country_name,\n    prc.wishlists,\n    prc.units as sales,\n    prc.event_date\n  FROM sandbox.agent_poc.partner_regions_and_countries prc\n  WHERE prc.app_id = 2456740\n    AND prc.scope = 'country'\n    AND prc.event_date >= DATE '2025-07-26'\n    AND prc.event_date <= DATE '2025-08-25'\n),\npeak_hours AS (\n  SELECT \n    country_name,\n    review_hour,\n    COUNT(*) as hour_count,\n    ROW_NUMBER() OVER (PARTITION BY country_name ORDER BY COUNT(*) DESC) as rn\n  FROM country_reviews\n  GROUP BY country_name, review_hour\n),\npeak_hour_summary AS (\n  SELECT \n    country_name,\n    review_hour as peak_response_hour\n  FROM peak_hours\n  WHERE rn = 1\n),\ncountry_summary AS (\n  SELECT \n    cr.country_name,\n    COUNT(DISTINCT cr.recommendationid) as total_reviews,\n    AVG(cr.hours_after_event) as avg_response_hours,\n    MIN(cr.hours_after_event) as fastest_response_hours,\n    COUNT(CASE WHEN cr.hours_after_event <= 24 THEN 1 END) as reviews_within_24h,\n    ROUND(COUNT(CASE WHEN cr.hours_after_event <= 24 THEN 1 END) * 100.0 / COUNT(*), 2) as response_rate_24h,\n    COUNT(CASE WHEN cr.voted_up = true THEN 1 END) as positive_reviews,\n    COUNT(CASE WHEN cr.voted_up = false THEN 1 END) as negative_reviews,\n    AVG(cr.votes_up) as avg_votes_up,\n    SUM(cw.wishlists) as total_wishlists,\n    SUM(cw.sales) as total_sales\n  FROM country_reviews cr\n  LEFT JOIN country_wishlist cw ON cr.country_name = cw.country_name\n  GROUP BY cr.country_name\n)\nSELECT \n  cs.country_name,\n  cs.total_reviews,\n  ROUND(cs.avg_response_hours, 2) as avg_response_hours,\n  cs.fastest_response_hours,\n  cs.reviews_within_24h,\n  cs.response_rate_24h,\n  cs.positive_reviews,\n  cs.negative_reviews,\n  ROUND(cs.positive_reviews * 100.0 / NULLIF(cs.total_reviews, 0), 2) as positive_ratio,\n  ROUND(cs.avg_votes_up, 2) as avg_votes_up,\n  phs.peak_response_hour,\n  cs.total_wishlists,\n  cs.total_sales,\n  RANK() OVER (ORDER BY cs.avg_response_hours ASC) as response_speed_rank,\n  RANK() OVER (ORDER BY cs.response_rate_24h DESC) as response_rate_rank\nFROM country_summary cs\nLEFT JOIN peak_hour_summary phs ON cs.country_name = phs.country_name\nORDER BY cs.avg_response_hours ASC\nLIMIT 20;",
    "category": "kpi",
    "difficulty": "medium"
  },
  {
    "id": "kpi_025",
    "question": "inZOI 게임(app_id: 2456740)의 트래픽 증가와 디스코드/스팀 소셜 반응의 연관성을 2025년 8월 18일부터 8월 25일까지 분석해주세요",
    "korean_question": "inZOI 게임(app_id: 2456740)의 트래픽 증가와 디스코드/스팀 소셜 반응의 연관성을 2025년 8월 18일부터 8월 25일까지 분석해주세요",
    "expected_sql": "WITH traffic_data AS (\n  SELECT \n    pt.event_date,\n    pt.app_id,\n    SUM(pt.visits) as total_visits,\n    SUM(pt.owner_visits) as owner_visits,\n    CASE \n      WHEN LAG(SUM(pt.visits)) OVER (PARTITION BY pt.app_id ORDER BY pt.event_date) > 0\n      THEN ROUND((SUM(pt.visits) - LAG(SUM(pt.visits)) OVER (PARTITION BY pt.app_id ORDER BY pt.event_date)) * 100.0 \n                 / LAG(SUM(pt.visits)) OVER (PARTITION BY pt.app_id ORDER BY pt.event_date), 2)\n      ELSE NULL\n    END as traffic_growth_rate\n  FROM sandbox.agent_poc.partner_traffic pt\n  WHERE pt.app_id = 2456740\n    AND pt.event_date >= DATE '2025-08-18'\n    AND pt.event_date <= DATE '2025-08-25'\n  GROUP BY pt.event_date, pt.app_id\n),\nsocial_data AS (\n  SELECT \n    m.event_date as reaction_date,\n    COUNT(DISTINCT m.message_id) as message_count,\n    COALESCE(SUM(r.count), 0) as reaction_count,\n    COUNT(DISTINCT m.author_id) as unique_authors\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n  GROUP BY m.event_date\n  \n  UNION ALL\n  \n  SELECT \n    sa.event_date as reaction_date,\n    COUNT(DISTINCT sa.recommendationid) as message_count,\n    SUM(sa.votes_up) as reaction_count,\n    NULL as unique_authors\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n  GROUP BY sa.event_date\n),\nsocial_summary AS (\n  SELECT \n    reaction_date,\n    SUM(message_count) as total_messages,\n    SUM(reaction_count) as total_reactions,\n    SUM(COALESCE(unique_authors, 0)) as total_authors\n  FROM social_data\n  GROUP BY reaction_date\n),\ncorrelation_analysis AS (\n  SELECT \n    td.event_date,\n    td.total_visits,\n    td.traffic_growth_rate,\n    COALESCE(ss.total_messages, 0) as social_messages,\n    COALESCE(ss.total_reactions, 0) as social_reactions,\n    COALESCE(ss.total_authors, 0) as social_authors,\n    CASE \n      WHEN LAG(COALESCE(ss.total_messages, 0)) OVER (ORDER BY td.event_date) > 0\n      THEN ROUND((COALESCE(ss.total_messages, 0) - \n                  LAG(COALESCE(ss.total_messages, 0)) OVER (ORDER BY td.event_date)) * 100.0 \n                 / LAG(COALESCE(ss.total_messages, 0)) OVER (ORDER BY td.event_date), 2)\n      ELSE NULL\n    END as social_growth_rate\n  FROM traffic_data td\n  LEFT JOIN social_summary ss ON td.event_date = ss.reaction_date\n)\nSELECT \n  event_date,\n  total_visits,\n  traffic_growth_rate,\n  social_messages,\n  social_reactions,\n  social_authors,\n  social_growth_rate,\n  CASE \n    WHEN traffic_growth_rate > 20 AND social_growth_rate > 20 THEN '강한 양의 상관관계'\n    WHEN traffic_growth_rate > 20 AND social_growth_rate < -20 THEN '강한 음의 상관관계'\n    WHEN traffic_growth_rate < -20 AND social_growth_rate > 20 THEN '역상관관계'\n    WHEN ABS(traffic_growth_rate) < 10 AND ABS(social_growth_rate) < 10 THEN '약한 상관관계'\n    ELSE '중간 상관관계'\n  END as correlation_type,\n  CASE \n    WHEN traffic_growth_rate > 20 AND LAG(social_growth_rate, 1) OVER (ORDER BY event_date) > 20 \n    THEN '1일 지연 효과'\n    WHEN traffic_growth_rate > 20 AND LAG(social_growth_rate, 2) OVER (ORDER BY event_date) > 20 \n    THEN '2일 지연 효과'\n    ELSE '즉시 반응'\n  END as response_timing\nFROM correlation_analysis\nWHERE traffic_growth_rate IS NOT NULL\nORDER BY event_date DESC;",
    "category": "kpi",
    "difficulty": "medium"
  },
  {
    "id": "kpi_026",
    "question": "inZOI 게임(app_id: 2456740)의 위시리스트 변화와 디스코드/스팀 반응의 관계를 2025년 8월 18일부터 8월 25일까지 분석해주세요",
    "korean_question": "inZOI 게임(app_id: 2456740)의 위시리스트 변화와 디스코드/스팀 반응의 관계를 2025년 8월 18일부터 8월 25일까지 분석해주세요",
    "expected_sql": "WITH wishlist_data AS (\n  SELECT \n    TO_DATE(pw.date_local, 'yyyy-MM-dd') as wishlist_date,\n    pw.app_id,\n    pw.adds as wishlist_adds,\n    pw.deletes as wishlist_deletes,\n    pw.purchases_and_activations as purchases,\n    pw.adds - pw.deletes as net_wishlist_change,\n    CASE \n      WHEN LAG(pw.adds - pw.deletes) OVER (PARTITION BY pw.app_id ORDER BY TO_DATE(pw.date_local, 'yyyy-MM-dd')) != 0\n      THEN ROUND(((pw.adds - pw.deletes) - \n                  LAG(pw.adds - pw.deletes) OVER (PARTITION BY pw.app_id ORDER BY TO_DATE(pw.date_local, 'yyyy-MM-dd'))) * 100.0 \n                 / ABS(LAG(pw.adds - pw.deletes) OVER (PARTITION BY pw.app_id ORDER BY TO_DATE(pw.date_local, 'yyyy-MM-dd'))), 2)\n      ELSE NULL\n    END as wishlist_change_rate\n  FROM sandbox.agent_poc.partner_wishlist pw\n  WHERE pw.app_id = '2456740'\n    AND TO_DATE(pw.date_local, 'yyyy-MM-dd') IS NOT NULL\n    AND TO_DATE(pw.date_local, 'yyyy-MM-dd') >= DATE '2025-08-18'\n    AND TO_DATE(pw.date_local, 'yyyy-MM-dd') <= DATE '2025-08-25'\n),\nsocial_data AS (\n  SELECT \n    m.event_date as reaction_date,\n    COUNT(DISTINCT m.message_id) as message_count,\n    COALESCE(SUM(r.count), 0) as reaction_count,\n    COUNT(DISTINCT m.author_id) as unique_authors\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n  GROUP BY m.event_date\n  \n  UNION ALL\n  \n  SELECT \n    sa.event_date as reaction_date,\n    COUNT(DISTINCT sa.recommendationid) as message_count,\n    SUM(sa.votes_up) as reaction_count,\n    NULL as unique_authors\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n  GROUP BY sa.event_date\n),\nsocial_summary AS (\n  SELECT \n    reaction_date,\n    SUM(message_count) as total_messages,\n    SUM(reaction_count) as total_reactions,\n    SUM(COALESCE(unique_authors, 0)) as total_authors\n  FROM social_data\n  GROUP BY reaction_date\n),\ncorrelation_analysis AS (\n  SELECT \n    wd.wishlist_date,\n    wd.wishlist_adds,\n    wd.wishlist_deletes,\n    wd.net_wishlist_change,\n    wd.wishlist_change_rate,\n    wd.purchases,\n    COALESCE(ss.total_messages, 0) as social_messages,\n    COALESCE(ss.total_reactions, 0) as social_reactions,\n    COALESCE(ss.total_authors, 0) as social_authors,\n    CASE \n      WHEN LAG(COALESCE(ss.total_messages, 0)) OVER (ORDER BY wd.wishlist_date) > 0\n      THEN ROUND((COALESCE(ss.total_messages, 0) - \n                  LAG(COALESCE(ss.total_messages, 0)) OVER (ORDER BY wd.wishlist_date)) * 100.0 \n                 / LAG(COALESCE(ss.total_messages, 0)) OVER (ORDER BY wd.wishlist_date), 2)\n      ELSE NULL\n    END as social_change_rate\n  FROM wishlist_data wd\n  LEFT JOIN social_summary ss ON wd.wishlist_date = ss.reaction_date\n)\nSELECT \n  wishlist_date,\n  wishlist_adds,\n  wishlist_deletes,\n  net_wishlist_change,\n  wishlist_change_rate,\n  purchases,\n  social_messages,\n  social_reactions,\n  social_authors,\n  social_change_rate,\n  CASE \n    WHEN wishlist_change_rate > 20 AND social_change_rate > 20 THEN '위시리스트 증가 → 소셜 반응 증가'\n    WHEN wishlist_change_rate < -20 AND social_change_rate > 20 THEN '위시리스트 감소 → 소셜 반응 증가 (역상관)'\n    WHEN wishlist_change_rate > 20 AND social_change_rate < -20 THEN '위시리스트 증가 → 소셜 반응 감소 (역상관)'\n    ELSE '약한 상관관계'\n  END as correlation_type\nFROM correlation_analysis\nWHERE wishlist_change_rate IS NOT NULL\nORDER BY wishlist_date DESC;",
    "category": "kpi",
    "difficulty": "medium"
  }
]