[
  {
    "id": "social_analytics_003",
    "question": "2025년 8월 18일부터 25일까지 inZOI의 전체 소셜 플랫폼(디스코드, 스팀 리뷰, 스팀 토픽)에서 반응이 있는 콘텐츠의 플랫폼별 반응 통계는 어떻게 되나요?",
    "korean_question": "2025년 8월 18일부터 25일까지 inZOI의 전체 소셜 플랫폼(디스코드, 스팀 리뷰, 스팀 토픽)에서 반응이 있는 콘텐츠의 플랫폼별 반응 통계는 어떻게 되나요?",
    "expected_sql": "WITH platform_data AS (\n  SELECT \n    'discord' as platform,\n    m.message_id as content_id,\n    m.message as content_text,\n    m.created_at as event_time,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n  GROUP BY m.message_id, m.message, m.created_at\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    CAST(sa.recommendationid AS STRING) as content_id,\n    sa.review as content_text,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    ct.topic_id as content_id,\n    ct.content as content_text,\n    FROM_UNIXTIME(ct.timestamp) as event_time,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url = ct.url) as reaction_count\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= DATE '2025-08-18'\n    AND ct.event_date <= DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n)\nSELECT \n  platform,\n  COUNT(*) as content_count,\n  SUM(reaction_count) as total_reactions,\n  MAX(reaction_count) as max_reactions,\n  MAX(content_text) as sample_content\nFROM platform_data\nWHERE reaction_count > 0\nGROUP BY platform\nORDER BY total_reactions DESC\nLIMIT 10;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_004",
    "question": "2025년 8월 25일 inZOI 디스코드에서 시간대별로 가장 활발한 채널은 어디인가요?",
    "korean_question": "2025년 8월 25일 inZOI 디스코드에서 시간대별로 가장 활발한 채널은 어디인가요?",
    "expected_sql": "WITH hot_messages AS (\n  SELECT \n    m.message_id,\n    m.created_at,\n    m.channel_id,\n    c.channel_name,\n    COALESCE(SUM(r.count), 0) as reaction_count,\n    DATE_TRUNC('hour', m.created_at) as hour_bucket\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  LEFT JOIN sandbox.agent_poc.channel_list c ON m.channel_id = c.channel_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date = DATE '2025-08-25'\n  GROUP BY m.message_id, m.created_at, m.channel_id, c.channel_name\n),\nchannel_hourly_stats AS (\n  SELECT \n    hour_bucket,\n    channel_name,\n    COUNT(*) as message_count,\n    SUM(reaction_count) as total_reactions,\n    AVG(reaction_count) as avg_reactions,\n    MAX(reaction_count) as max_reactions\n  FROM hot_messages\n  GROUP BY hour_bucket, channel_name\n)\nSELECT \n  hour_bucket,\n  channel_name,\n  message_count,\n  total_reactions,\n  ROUND(avg_reactions, 2) as avg_reactions,\n  max_reactions\nFROM channel_hourly_stats\nORDER BY total_reactions DESC\nLIMIT 10;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_006",
    "question": "2025년 8월 25일 inZOI의 플랫폼별(디스코드, 스팀 리뷰, 스팀 토픽, 스팀 코멘트) 콘텐츠 통계(디스코드는 메시지 길이 10자 초과만)는 어떻게 되나요?",
    "korean_question": "2025년 8월 25일 inZOI의 플랫폼별(디스코드, 스팀 리뷰, 스팀 토픽, 스팀 코멘트) 콘텐츠 통계(디스코드는 메시지 길이 10자 초과만)는 어떻게 되나요?",
    "expected_sql": "WITH content_stats AS (\n  SELECT \n    'discord' as platform,\n    COUNT(DISTINCT m.message_id) as content_count,\n    COALESCE(SUM(r.count), 0) as total_reactions,\n    AVG(LENGTH(m.message)) as avg_message_length\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date = DATE '2025-08-25'\n    AND m.message IS NOT NULL\n    AND LENGTH(m.message) > 10\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    COUNT(DISTINCT sa.recommendationid) as content_count,\n    SUM(sa.votes_up) as total_reactions,\n    AVG(LENGTH(sa.review)) as avg_message_length\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date = DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    COUNT(DISTINCT ct.topic_id) as content_count,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url IN (SELECT url FROM sandbox.agent_poc.community_discussions_topics \n                             WHERE app_id = 2456740 \n                             AND event_date = DATE '2025-08-25')) as total_reactions,\n    AVG(LENGTH(ct.content)) as avg_message_length\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date = DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_comment' as platform,\n    COUNT(DISTINCT cc.comment_id) as content_count,\n    0 as total_reactions,\n    AVG(LENGTH(cc.content)) as avg_message_length\n  FROM sandbox.agent_poc.community_discussions_comments cc\n  WHERE cc.app_id = 2456740\n    AND cc.event_date = DATE '2025-08-25'\n    AND cc.content IS NOT NULL\n)\nSELECT \n  platform,\n  content_count,\n  total_reactions,\n  ROUND(avg_message_length, 2) as avg_content_length\nFROM content_stats\nORDER BY content_count DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_009",
    "question": "2025년 8월 18일부터 25일까지 inZOI의 긍정/부정 동향별(디스코드는 반응 5개 이상, 스팀 리뷰는 추천 여부별 추천 수 10개 이상) 플랫폼별 반응 통계를 보여줘",
    "korean_question": "2025년 8월 18일부터 25일까지 inZOI의 긍정/부정 동향별(디스코드는 반응 5개 이상, 스팀 리뷰는 추천 여부별 추천 수 10개 이상) 플랫폼별 반응 통계를 보여줘",
    "expected_sql": "WITH sentiment_data AS (\n  SELECT \n    'discord' as platform,\n    m.message_id as content_id,\n    m.created_at as event_time,\n    COALESCE(SUM(r.count), 0) as reaction_count,\n    'high_engagement' as sentiment_type\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n  GROUP BY m.message_id, m.created_at\n  HAVING COALESCE(SUM(r.count), 0) >= 5\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    CAST(sa.recommendationid AS STRING) as content_id,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count,\n    'positive' as sentiment_type\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.voted_up = true\n    AND sa.votes_up >= 10\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    CAST(sa.recommendationid AS STRING) as content_id,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count,\n    'negative' as sentiment_type\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.voted_up = false\n    AND sa.votes_up >= 10\n)\nSELECT \n  sentiment_type,\n  platform,\n  COUNT(*) as content_count,\n  SUM(reaction_count) as total_reactions,\n  AVG(reaction_count) as avg_reactions,\n  MAX(reaction_count) as max_reactions,\n  MIN(event_time) as earliest_time,\n  MAX(event_time) as latest_time\nFROM sentiment_data\nGROUP BY sentiment_type, platform\nORDER BY sentiment_type, total_reactions DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_010",
    "question": "2025년 8월 18일부터 25일까지 inZOI의 부정 동향(디스코드는 반응 5개 이상, 스팀 리뷰는 추천하지 않음) 콘텐츠의 플랫폼별 통계는 어떻게 되나요?",
    "korean_question": "2025년 8월 18일부터 25일까지 inZOI의 부정 동향(디스코드는 반응 5개 이상, 스팀 리뷰는 추천하지 않음) 콘텐츠의 플랫폼별 통계는 어떻게 되나요?",
    "expected_sql": "WITH negative_content AS (\n  SELECT \n    'discord' as platform,\n    m.message_id as content_id,\n    m.created_at as event_time,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n    AND m.message IS NOT NULL\n  GROUP BY m.message_id, m.created_at\n  HAVING COALESCE(SUM(r.count), 0) >= 5\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    CAST(sa.recommendationid AS STRING) as content_id,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.voted_up = false\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    ct.topic_id as content_id,\n    FROM_UNIXTIME(ct.timestamp) as event_time,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url = ct.url) as reaction_count\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= DATE '2025-08-18'\n    AND ct.event_date <= DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n)\nSELECT \n  platform,\n  COUNT(*) as content_count,\n  SUM(reaction_count) as total_reactions,\n  AVG(reaction_count) as avg_reactions,\n  MAX(reaction_count) as max_reactions,\n  MIN(event_time) as earliest_time,\n  MAX(event_time) as latest_time\nFROM negative_content\nGROUP BY platform\nORDER BY total_reactions DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_011",
    "question": "2025년 7월 26일부터 8월 25일까지 inZOI 스팀에서 부정 리뷰가 급증한(전일 대비 50% 이상 증가 또는 부정 리뷰 20개 이상이면서 부정 비율 40% 이상) 시점과 통계는 어떻게 되나요?",
    "korean_question": "2025년 7월 26일부터 8월 25일까지 inZOI 스팀에서 부정 리뷰가 급증한(전일 대비 50% 이상 증가 또는 부정 리뷰 20개 이상이면서 부정 비율 40% 이상) 시점과 통계는 어떻게 되나요?",
    "expected_sql": "-- event_date 기준으로 일자별 그룹핑\nWITH daily_reviews AS (\n  SELECT \n    sa.event_date as review_date,\n    COUNT(*) as total_reviews,\n    COUNT(CASE WHEN voted_up = false THEN 1 END) as negative_reviews,\n    COUNT(CASE WHEN voted_up = true THEN 1 END) as positive_reviews,\n    ROUND(COUNT(CASE WHEN voted_up = false THEN 1 END) * 100.0 / COUNT(*), 2) as negative_ratio\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-07-26'\n    AND sa.event_date <= DATE '2025-08-25'\n  GROUP BY sa.event_date\n),\nspike_detection AS (\n  SELECT \n    review_date,\n    total_reviews,\n    negative_reviews,\n    positive_reviews,\n    negative_ratio,\n    CASE \n      WHEN LAG(negative_reviews) OVER (ORDER BY review_date) > 0 \n      THEN ROUND((negative_reviews - LAG(negative_reviews) OVER (ORDER BY review_date)) * 100.0 \n                 / LAG(negative_reviews) OVER (ORDER BY review_date), 2)\n      ELSE NULL\n    END as negative_growth_rate\n  FROM daily_reviews\n),\nspike_dates AS (\n  SELECT review_date\n  FROM spike_detection\n  WHERE negative_growth_rate >= 50\n     OR (negative_reviews >= 20 AND negative_ratio >= 40)\n),\nnegative_reviews_detail AS (\n  SELECT \n    sa.event_date as review_date,\n    COUNT(*) as spike_day_negative_count,\n    AVG(sa.votes_up) as avg_votes_up,\n    MAX(sa.votes_up) as max_votes_up\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.voted_up = false\n    AND sa.event_date IN (SELECT review_date FROM spike_dates)\n    AND sa.review IS NOT NULL\n  GROUP BY sa.event_date\n)\nSELECT \n  sd.review_date,\n  sd.total_reviews,\n  sd.negative_reviews,\n  sd.positive_reviews,\n  sd.negative_ratio,\n  sd.negative_growth_rate,\n  nrd.spike_day_negative_count,\n  ROUND(nrd.avg_votes_up, 2) as avg_votes_up,\n  nrd.max_votes_up\nFROM spike_detection sd\nLEFT JOIN negative_reviews_detail nrd ON sd.review_date = nrd.review_date\nWHERE sd.review_date IN (SELECT review_date FROM spike_dates)\nORDER BY sd.review_date DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_014",
    "question": "2025년 8월 18일부터 25일까지 inZOI의 디스코드와 스팀(리뷰, 토픽) 플랫폼별 콘텐츠 및 반응 통계는 어떻게 되나요?",
    "korean_question": "2025년 8월 18일부터 25일까지 inZOI의 디스코드와 스팀(리뷰, 토픽) 플랫폼별 콘텐츠 및 반응 통계는 어떻게 되나요?",
    "expected_sql": "WITH discord_stats AS (\n  SELECT \n    'discord' as platform,\n    COUNT(DISTINCT m.message_id) as content_count,\n    COALESCE(SUM(r.count), 0) as total_reactions,\n    AVG(LENGTH(m.message)) as avg_message_length\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n),\nsteam_stats AS (\n  SELECT \n    'steam_review' as platform,\n    COUNT(DISTINCT sa.recommendationid) as content_count,\n    SUM(sa.votes_up) as total_reactions,\n    AVG(LENGTH(sa.review)) as avg_message_length\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    COUNT(DISTINCT ct.topic_id) as content_count,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url IN (SELECT url FROM sandbox.agent_poc.community_discussions_topics \n                             WHERE app_id = 2456740 \n                             AND event_date >= DATE '2025-08-18'\n                             AND event_date <= DATE '2025-08-25')) as total_reactions,\n    AVG(LENGTH(ct.content)) as avg_message_length\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= DATE '2025-08-18'\n    AND ct.event_date <= DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n)\nSELECT \n  platform,\n  content_count,\n  total_reactions,\n  ROUND(avg_message_length, 2) as avg_content_length,\n  ROUND(total_reactions * 100.0 / SUM(total_reactions) OVER (), 2) as reaction_percentage\nFROM (\n  SELECT * FROM discord_stats\n  UNION ALL\n  SELECT * FROM steam_stats\n) combined_stats\nORDER BY total_reactions DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_016",
    "question": "2025년 8월 25일 inZOI의 디스코드(메시지)와 스팀(리뷰, 토픽)에서 시간대별 반응 통계를 보여줘",
    "korean_question": "2025년 8월 25일 inZOI의 디스코드(메시지)와 스팀(리뷰, 토픽)에서 시간대별 반응 통계를 보여줘",
    "expected_sql": "WITH all_events AS (\n  SELECT \n    'discord' as platform,\n    'message' as event_type,\n    m.message_id as event_id,\n    m.message as content_text,\n    m.created_at as event_time,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date = DATE '2025-08-25'\n  GROUP BY m.message_id, m.message, m.created_at\n  \n  UNION ALL\n  \n  SELECT \n    'steam' as platform,\n    'review' as event_type,\n    CAST(sa.recommendationid AS STRING) as event_id,\n    sa.review as content_text,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date = DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam' as platform,\n    'topic' as event_type,\n    ct.topic_id as event_id,\n    ct.content as content_text,\n    FROM_UNIXTIME(ct.timestamp) as event_time,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url = ct.url) as reaction_count\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date = DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n),\nhourly_summary AS (\n  SELECT \n    DATE_TRUNC('hour', event_time) as hour_bucket,\n    platform,\n    event_type,\n    COUNT(*) as event_count,\n    SUM(reaction_count) as total_reactions,\n    MAX(reaction_count) as max_reactions,\n    MAX(content_text) as top_content\n  FROM all_events\n  GROUP BY DATE_TRUNC('hour', event_time), platform, event_type\n)\nSELECT \n  hour_bucket,\n  platform,\n  event_type,\n  event_count,\n  total_reactions,\n  max_reactions,\n  top_content as sample_content\nFROM hourly_summary\nORDER BY hour_bucket DESC, platform, event_type;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_017",
    "question": "2025년 8월 25일 14시 전후 1시간 동안 inZOI 디스코드에서 채널별 활동 통계는 어떻게 되나요?",
    "korean_question": "2025년 8월 25일 14시 전후 1시간 동안 inZOI 디스코드에서 채널별 활동 통계는 어떻게 되나요?",
    "expected_sql": "WITH discord_conversations AS (\n  SELECT \n    m.message_id,\n    m.created_at,\n    m.channel_id,\n    c.channel_name,\n    m.thread_id,\n    t.thread_title,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  LEFT JOIN sandbox.agent_poc.channel_list c ON m.channel_id = c.channel_id\n  LEFT JOIN sandbox.agent_poc.thread_list t ON m.thread_id = t.thread_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date = DATE '2025-08-25'\n    AND m.created_at >= TIMESTAMP '2025-08-25 14:00:00' - INTERVAL 1 HOUR\n    AND m.created_at <= TIMESTAMP '2025-08-25 14:00:00' + INTERVAL 1 HOUR\n  GROUP BY m.message_id, m.created_at, m.channel_id, c.channel_name, \n           m.thread_id, t.thread_title\n),\nchannel_stats AS (\n  SELECT \n    channel_name,\n    COUNT(*) as message_count,\n    SUM(reaction_count) as total_reactions,\n    AVG(reaction_count) as avg_reactions,\n    MAX(reaction_count) as max_reactions,\n    MIN(created_at) as first_message_time,\n    MAX(created_at) as last_message_time\n  FROM discord_conversations\n  GROUP BY channel_name\n)\nSELECT \n  channel_name,\n  message_count,\n  total_reactions,\n  ROUND(avg_reactions, 2) as avg_reactions,\n  max_reactions,\n  first_message_time,\n  last_message_time\nFROM channel_stats\nORDER BY total_reactions DESC\nLIMIT 10;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_018",
    "question": "2025년 7월 26일부터 8월 25일까지 inZOI 스팀의 트래픽이 급증한(전일 대비 30% 이상 증가 또는 평균의 1.8배 이상) 시점 전후 하루 동안 소셜 플랫폼별(디스코드, 스팀 리뷰, 스팀 토픽) 활동 통계는 어떻게 되나요?",
    "korean_question": "2025년 7월 26일부터 8월 25일까지 inZOI 스팀의 트래픽이 급증한(전일 대비 30% 이상 증가 또는 평균의 1.8배 이상) 시점 전후 하루 동안 소셜 플랫폼별(디스코드, 스팀 리뷰, 스팀 토픽) 활동 통계는 어떻게 되나요?",
    "expected_sql": "WITH traffic_data AS (\n  SELECT \n    pt.event_date,\n    pt.app_id,\n    pt.visits,\n    CASE \n      WHEN LAG(pt.visits) OVER (PARTITION BY pt.app_id ORDER BY pt.event_date) > 0 \n      THEN ROUND((pt.visits - LAG(pt.visits) OVER (PARTITION BY pt.app_id ORDER BY pt.event_date)) * 100.0 \n                 / LAG(pt.visits) OVER (PARTITION BY pt.app_id ORDER BY pt.event_date), 2)\n      ELSE NULL\n    END as growth_rate\n  FROM sandbox.agent_poc.partner_traffic pt\n  WHERE pt.app_id = 2456740\n    AND pt.event_date >= DATE '2025-07-26'\n    AND pt.event_date <= DATE '2025-08-25'\n),\ntraffic_spikes AS (\n  SELECT \n    event_date,\n    app_id,\n    visits,\n    growth_rate\n  FROM traffic_data\n  WHERE growth_rate >= 30  -- 급증 기준: 전일 대비 30% 이상 증가\n     OR visits >= (SELECT AVG(visits) * 1.8 FROM traffic_data)  -- 또는 평균의 1.8배 이상\n),\n-- Discord 반응 데이터 (트래픽 스파이크 날짜 범위 내, event_date 기준)\ndiscord_reactions AS (\n  SELECT \n    m.event_date,\n    COUNT(DISTINCT m.message_id) as content_count,\n    COALESCE(SUM(r.count), 0) as total_reactions\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= (SELECT MIN(event_date) - INTERVAL 1 DAY FROM traffic_spikes)\n    AND m.event_date <= (SELECT MAX(event_date) + INTERVAL 1 DAY FROM traffic_spikes)\n  GROUP BY m.event_date\n),\n-- Steam 리뷰 반응 데이터 (event_date 기준)\nsteam_review_reactions AS (\n  SELECT \n    sa.event_date,\n    COUNT(DISTINCT sa.recommendationid) as content_count,\n    SUM(sa.votes_up) as total_reactions\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= (SELECT MIN(event_date) - INTERVAL 1 DAY FROM traffic_spikes)\n    AND sa.event_date <= (SELECT MAX(event_date) + INTERVAL 1 DAY FROM traffic_spikes)\n    AND sa.review IS NOT NULL\n  GROUP BY sa.event_date\n),\n-- Steam 토픽 코멘트 수 계산 (event_date 기준)\nsteam_topic_comments AS (\n  SELECT \n    ct.event_date,\n    COUNT(DISTINCT cc.comment_id) as total_reactions\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  INNER JOIN sandbox.agent_poc.community_discussions_comments cc \n    ON cc.topic_url = ct.url\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= (SELECT MIN(event_date) - INTERVAL 1 DAY FROM traffic_spikes)\n    AND ct.event_date <= (SELECT MAX(event_date) + INTERVAL 1 DAY FROM traffic_spikes)\n  GROUP BY ct.event_date\n),\n-- Steam 토픽 반응 데이터 (event_date 기준)\nsteam_topic_reactions AS (\n  SELECT \n    ct.event_date,\n    COUNT(DISTINCT ct.topic_id) as content_count,\n    COALESCE(stc.total_reactions, 0) as total_reactions\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  LEFT JOIN steam_topic_comments stc \n    ON ct.event_date = stc.event_date\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= (SELECT MIN(event_date) - INTERVAL 1 DAY FROM traffic_spikes)\n    AND ct.event_date <= (SELECT MAX(event_date) + INTERVAL 1 DAY FROM traffic_spikes)\n    AND ct.content IS NOT NULL\n  GROUP BY ct.event_date, stc.total_reactions\n),\n-- 플랫폼별 소셜 반응 통합\nsocial_reactions AS (\n  SELECT \n    'discord' as platform,\n    event_date,\n    content_count,\n    total_reactions\n  FROM discord_reactions\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    event_date,\n    content_count,\n    total_reactions\n  FROM steam_review_reactions\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    event_date,\n    content_count,\n    total_reactions\n  FROM steam_topic_reactions\n)\n-- 트래픽 스파이크와 소셜 반응 매칭 (날짜 범위 조인)\nSELECT \n  ts.event_date as traffic_spike_date,\n  ts.visits as traffic_visits,\n  ts.growth_rate as traffic_growth_rate,\n  sr.platform,\n  SUM(sr.content_count) as total_content,\n  SUM(sr.total_reactions) as total_engagement\nFROM traffic_spikes ts\nLEFT JOIN social_reactions sr \n  ON sr.event_date BETWEEN ts.event_date - INTERVAL 1 DAY \n                       AND ts.event_date + INTERVAL 1 DAY\nGROUP BY ts.event_date, ts.visits, ts.growth_rate, sr.platform\nORDER BY ts.event_date DESC, sr.platform;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_022",
    "question": "2025년 7월 26일부터 8월 25일까지 inZOI 스팀의 지역별 위시리스트와 판매량 통계는 어떻게 되나요?",
    "korean_question": "2025년 7월 26일부터 8월 25일까지 inZOI 스팀의 지역별 위시리스트와 판매량 통계는 어떻게 되나요?",
    "expected_sql": "-- 지역별 위시리스트 및 판매량 데이터 (리뷰 데이터는 성능상 별도 쿼리 권장)\nSELECT \n  prc.scope,\n  prc.name as region_name,\n  COUNT(DISTINCT prc.event_date) as days_tracked,\n  SUM(prc.wishlists) as total_wishlists,\n  SUM(prc.units) as total_sales,\n  ROUND(AVG(prc.wishlists), 2) as avg_daily_wishlists,\n  ROUND(AVG(prc.units), 2) as avg_daily_sales,\n  MIN(prc.event_date) as period_start,\n  MAX(prc.event_date) as period_end\nFROM sandbox.agent_poc.partner_regions_and_countries prc\nWHERE prc.app_id = 2456740\n  AND prc.scope = 'region'\n  AND prc.event_date >= DATE '2025-07-26'\n  AND prc.event_date <= DATE '2025-08-25'\nGROUP BY prc.scope, prc.name\nORDER BY total_sales DESC\nLIMIT 10;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_024",
    "question": "2025년 8월 18일부터 9월 8일까지 inZOI의 마케팅 캠페인(기간: 8월 25일-9월 1일) 전후 기간별 소셜 플랫폼(디스코드, 스팀 리뷰) 반응 변화는 무엇인가요?",
    "korean_question": "2025년 8월 18일부터 9월 8일까지 inZOI의 마케팅 캠페인(기간: 8월 25일-9월 1일) 전후 기간별 소셜 플랫폼(디스코드, 스팀 리뷰) 반응 변화는 무엇인가요?",
    "expected_sql": "WITH discord_activity AS (\n  SELECT \n    CASE \n      WHEN m.event_date < DATE '2025-08-25' THEN 'before'\n      WHEN m.event_date BETWEEN DATE '2025-08-25' AND DATE '2025-09-01' THEN 'during'\n      ELSE 'after'\n    END as period,\n    COUNT(DISTINCT m.message_id) as message_count,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date BETWEEN DATE '2025-08-18'\n                          AND DATE '2025-09-08'\n  GROUP BY \n    CASE \n      WHEN m.event_date < DATE '2025-08-25' THEN 'before'\n      WHEN m.event_date BETWEEN DATE '2025-08-25' AND DATE '2025-09-01' THEN 'during'\n      ELSE 'after'\n    END\n),\nsteam_activity AS (\n  SELECT \n    CASE \n      WHEN sa.event_date < DATE '2025-08-25' THEN 'before'\n      WHEN sa.event_date BETWEEN DATE '2025-08-25' AND DATE '2025-09-01' THEN 'during'\n      ELSE 'after'\n    END as period,\n    COUNT(DISTINCT sa.recommendationid) as review_count,\n    SUM(sa.votes_up) as total_votes_up\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date BETWEEN DATE '2025-08-18'\n                           AND DATE '2025-09-08'\n    AND sa.review IS NOT NULL\n  GROUP BY \n    CASE \n      WHEN sa.event_date < DATE '2025-08-25' THEN 'before'\n      WHEN sa.event_date BETWEEN DATE '2025-08-25' AND DATE '2025-09-01' THEN 'during'\n      ELSE 'after'\n    END\n),\ncomparison_summary AS (\n  SELECT \n    'discord' as platform,\n    period,\n    SUM(message_count) as activity_count,\n    SUM(reaction_count) as engagement_count\n  FROM discord_activity\n  GROUP BY period\n  \n  UNION ALL\n  \n  SELECT \n    'steam' as platform,\n    period,\n    SUM(review_count) as activity_count,\n    SUM(total_votes_up) as engagement_count\n  FROM steam_activity\n  GROUP BY period\n)\nSELECT \n  platform,\n  period,\n  activity_count,\n  engagement_count\nFROM comparison_summary\nORDER BY platform, \n  CASE period WHEN 'before' THEN 1 WHEN 'during' THEN 2 ELSE 3 END;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_027",
    "question": "2025년 8월 25일 하루 동안 inZOI의 플랫폼별(디스코드, 스팀 리뷰, 스팀 토픽) 소셜 활동 통계를 요약해주세요",
    "korean_question": "2025년 8월 25일 하루 동안 inZOI의 플랫폼별(디스코드, 스팀 리뷰, 스팀 토픽) 소셜 활동 통계를 요약해주세요",
    "expected_sql": "WITH today_events AS (\n  SELECT \n    'discord' as platform,\n    m.message_id as content_id,\n    m.created_at as event_time,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date = DATE '2025-08-25'\n  GROUP BY m.message_id, m.created_at\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    CAST(sa.recommendationid AS STRING) as content_id,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date = DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    ct.topic_id as content_id,\n    FROM_UNIXTIME(ct.timestamp) as event_time,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url = ct.url) as reaction_count\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date = DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n),\nplatform_summary AS (\n  SELECT \n    platform,\n    COUNT(DISTINCT content_id) as total_content,\n    SUM(reaction_count) as total_reactions,\n    AVG(reaction_count) as avg_reactions,\n    MAX(reaction_count) as max_reactions,\n    MIN(event_time) as earliest_time,\n    MAX(event_time) as latest_time\n  FROM today_events\n  GROUP BY platform\n)\nSELECT \n  platform,\n  total_content,\n  total_reactions,\n  ROUND(avg_reactions, 2) as avg_reactions,\n  max_reactions,\n  earliest_time,\n  latest_time\nFROM platform_summary\nORDER BY total_reactions DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_028",
    "question": "2025년 8월 18일부터 25일까지 inZOI의 주요 소셜 반응을 플랫폼별(디스코드, 스팀)로 요약해주세요",
    "korean_question": "2025년 8월 18일부터 25일까지 inZOI의 주요 소셜 반응을 플랫폼별(디스코드, 스팀)로 요약해주세요",
    "expected_sql": "WITH discord_weekly AS (\n  SELECT \n    'discord' as platform,\n    COUNT(DISTINCT m.message_id) as total_messages,\n    COALESCE(SUM(r.count), 0) as total_reactions\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n),\nsteam_weekly AS (\n  SELECT \n    'steam' as platform,\n    COUNT(DISTINCT sa.recommendationid) as total_reviews,\n    SUM(sa.votes_up) as total_votes_up\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n)\nSELECT \n  platform,\n  total_messages as activity_count,\n  total_reactions as engagement_count\nFROM discord_weekly\n\nUNION ALL\n\nSELECT \n  platform,\n  total_reviews as activity_count,\n  total_votes_up as engagement_count\nFROM steam_weekly\nORDER BY platform;",
    "category": "social_analytics",
    "difficulty": "medium"
  },
  {
    "id": "social_analytics_029",
    "question": "2025년 8월 18일부터 25일까지 inZOI의 디스코드와 스팀(리뷰, 토픽)의 주요 반응을 통합해서 요약(스팀 리뷰의 긍정/부정 비율 포함)해주세요",
    "korean_question": "2025년 8월 18일부터 25일까지 inZOI의 디스코드와 스팀(리뷰, 토픽)의 주요 반응을 통합해서 요약(스팀 리뷰의 긍정/부정 비율 포함)해주세요",
    "expected_sql": "WITH integrated_data AS (\n  SELECT \n    'discord' as platform,\n    m.message_id as content_id,\n    m.created_at as event_time,\n    COALESCE(SUM(r.count), 0) as reaction_count,\n    NULL as sentiment\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= DATE '2025-08-18'\n    AND m.event_date <= DATE '2025-08-25'\n  GROUP BY m.message_id, m.created_at\n  \n  UNION ALL\n  \n  SELECT \n    'steam_review' as platform,\n    CAST(sa.recommendationid AS STRING) as content_id,\n    FROM_UNIXTIME(sa.timestamp_created) as event_time,\n    sa.votes_up as reaction_count,\n    CASE WHEN sa.voted_up = true THEN 'positive' ELSE 'negative' END as sentiment\n  FROM sandbox.agent_poc.store_appreviews sa\n  WHERE sa.app_id = 2456740\n    AND sa.event_date >= DATE '2025-08-18'\n    AND sa.event_date <= DATE '2025-08-25'\n    AND sa.review IS NOT NULL\n  \n  UNION ALL\n  \n  SELECT \n    'steam_topic' as platform,\n    ct.topic_id as content_id,\n    FROM_UNIXTIME(ct.timestamp) as event_time,\n    (SELECT COUNT(DISTINCT cc.comment_id) \n     FROM sandbox.agent_poc.community_discussions_comments cc \n     WHERE cc.topic_url = ct.url) as reaction_count,\n    NULL as sentiment\n  FROM sandbox.agent_poc.community_discussions_topics ct\n  WHERE ct.app_id = 2456740\n    AND ct.event_date >= DATE '2025-08-18'\n    AND ct.event_date <= DATE '2025-08-25'\n    AND ct.content IS NOT NULL\n),\nplatform_stats AS (\n  SELECT \n    platform,\n    COUNT(DISTINCT content_id) as total_content,\n    SUM(reaction_count) as total_reactions,\n    AVG(reaction_count) as avg_reactions,\n    MAX(reaction_count) as max_reactions,\n    COUNT(CASE WHEN sentiment = 'positive' THEN 1 END) as positive_count,\n    COUNT(CASE WHEN sentiment = 'negative' THEN 1 END) as negative_count\n  FROM integrated_data\n  GROUP BY platform\n),\noverall_stats AS (\n  SELECT \n    COUNT(DISTINCT content_id) as total_content_all,\n    SUM(reaction_count) as total_reactions_all,\n    COUNT(CASE WHEN sentiment = 'positive' THEN 1 END) as total_positive,\n    COUNT(CASE WHEN sentiment = 'negative' THEN 1 END) as total_negative,\n    ROUND(COUNT(CASE WHEN sentiment = 'positive' THEN 1 END) * 100.0 / \n          NULLIF(COUNT(CASE WHEN sentiment IN ('positive', 'negative') THEN 1 END), 0), 2) as positive_ratio\n  FROM integrated_data\n)\nSELECT \n  '=== 통합 소셜 반응 통계 ===' as section,\n  CAST(total_content_all AS STRING) || '개 콘텐츠, ' || \n  CAST(total_reactions_all AS STRING) || '개 반응, ' ||\n  CAST(COALESCE(positive_ratio, 0) AS STRING) || '% 긍정 (스팀 리뷰 기준)' as detail\nFROM overall_stats\n\nUNION ALL\n\nSELECT \n  '플랫폼별 통계' as section,\n  platform || ': ' || total_content || '개 콘텐츠, ' || total_reactions || '개 반응, ' ||\n  COALESCE(CAST(positive_count AS STRING), 'N/A') || '개 긍정, ' ||\n  COALESCE(CAST(negative_count AS STRING), 'N/A') || '개 부정' as detail\nFROM platform_stats\nORDER BY total_reactions DESC;",
    "category": "social_analytics",
    "difficulty": "medium"
  }
]