{
  "benchmarks": [
    {
      "id": "353538e47adb4badba4d7d9880ab7b71",
      "question": "What are the Discord messages with the most reactions?",
      "expected_sql": "SELECT \n  m.message_id,\n  m.created_at,\n  c.channel_name,\n  COALESCE(SUM(r.count), 0) as reaction_count,\n  COUNT(DISTINCT r.emoji_name) as unique_emojis\nFROM sandbox.agent_poc.message m\nLEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\nLEFT JOIN sandbox.agent_poc.channel_list c ON m.channel_id = c.channel_id\nWHERE m.game_code = 'inzoi'\n  AND m.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\nGROUP BY m.message_id, m.created_at, c.channel_name\nHAVING COALESCE(SUM(r.count), 0) > 0\nORDER BY reaction_count DESC\nLIMIT 10;",
      "korean_question": "디스코드에서 리액션이 가장 많은 메시지는 무엇인가요?",
      "source_file": "KPI_benchmark.md",
      "question_number": 1
    },
    {
      "id": "e8803a14a376458199548c9da8cc8791",
      "question": "What are the Steam reviews with the highest upvote counts?",
      "expected_sql": "WITH latest_reviews AS (\n  SELECT \n    r.recommendationid,\n    r.author.steamid as author_steamid,\n    r.votes_up,\n    r.weighted_vote_score,\n    r.voted_up,\n    r.timestamp_created,\n    ROW_NUMBER() OVER (PARTITION BY r.recommendationid ORDER BY r.event_date DESC) as rn\n  FROM sandbox.agent_poc.store_appreviews r\n  INNER JOIN sandbox.agent_poc.steam_apps s ON r.app_id = s.app_id\n  WHERE s.game_code = 'inzoi'\n    AND r.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n)\nSELECT \n  recommendationid,\n  author_steamid,\n  votes_up,\n  weighted_vote_score,\n  voted_up,\n  timestamp_created\nFROM latest_reviews\nWHERE rn = 1\nORDER BY votes_up DESC, CAST(weighted_vote_score AS DOUBLE) DESC\nLIMIT 10;",
      "korean_question": "스팀 리뷰에서 추천 수가 높은 리뷰는 무엇인가요?",
      "source_file": "KPI_benchmark.md",
      "question_number": 2
    },
    {
      "id": "a1254ac29da947a0875b5a31d4ff2700",
      "question": "What are the Steam community topics with the most comments?",
      "expected_sql": "WITH latest_topics AS (\n  SELECT \n    t.url,\n    t.title,\n    t.author,\n    t.timestamp,\n    ROW_NUMBER() OVER (PARTITION BY t.url ORDER BY t.event_date DESC) as rn\n  FROM sandbox.agent_poc.community_discussions_topics t\n  INNER JOIN sandbox.agent_poc.steam_apps s ON t.app_id = s.app_id\n  WHERE s.game_code = 'inzoi'\n    AND t.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n),\nlatest_comments AS (\n  SELECT \n    c.topic_url,\n    c.comment_id,\n    ROW_NUMBER() OVER (PARTITION BY c.comment_id ORDER BY c.event_date DESC) as rn\n  FROM sandbox.agent_poc.community_discussions_comments c\n  WHERE c.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n)\nSELECT \n  t.url as topic_url,\n  t.title,\n  t.author,\n  t.timestamp as created_at,\n  COUNT(DISTINCT c.comment_id) as comment_count\nFROM latest_topics t\nLEFT JOIN latest_comments c ON t.url = c.topic_url AND c.rn = 1\nWHERE t.rn = 1\nGROUP BY t.url, t.title, t.author, t.timestamp\nORDER BY comment_count DESC\nLIMIT 10;",
      "korean_question": "스팀 커뮤니티에서 댓글이 많이 달린 토픽은 무엇인가요?",
      "source_file": "KPI_benchmark.md",
      "question_number": 3
    },
    {
      "id": "b3b48b78c56442518e0de8cb432ddbaa",
      "question": "Which Discord channels are the most active?",
      "expected_sql": "SELECT \n  c.channel_name,\n  COUNT(DISTINCT m.message_id) as message_count,\n  COALESCE(SUM(r.count), 0) as reaction_count,\n  COUNT(DISTINCT m.message_id) + (COALESCE(SUM(r.count), 0) * 0.5) as activity_score\nFROM sandbox.agent_poc.message m\nINNER JOIN sandbox.agent_poc.channel_list c ON m.channel_id = c.channel_id\nLEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\nWHERE m.game_code = 'inzoi'\n  AND m.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\nGROUP BY c.channel_name\nORDER BY activity_score DESC\nLIMIT 10;",
      "korean_question": "디스코드에서 가장 활발한 채널은 어디인가요?",
      "source_file": "KPI_benchmark.md",
      "question_number": 4
    },
    {
      "id": "9a22e4334c0042089e1839c1608f6999",
      "question": "What are the peak hours for mentions across platforms?",
      "expected_sql": "WITH discord_hourly AS (\n  SELECT \n    HOUR(created_at) as hour,\n    COUNT(*) as mention_count\n  FROM sandbox.agent_poc.message\n  WHERE game_code = 'inzoi'\n    AND event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n  GROUP BY HOUR(created_at)\n),\nlatest_steam_reviews AS (\n  SELECT \n    r.timestamp_created,\n    ROW_NUMBER() OVER (PARTITION BY r.recommendationid ORDER BY r.event_date DESC) as rn\n  FROM sandbox.agent_poc.store_appreviews r\n  INNER JOIN sandbox.agent_poc.steam_apps s ON r.app_id = s.app_id\n  WHERE s.game_code = 'inzoi'\n    AND r.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n),\nsteam_hourly AS (\n  SELECT \n    HOUR(FROM_UNIXTIME(timestamp_created)) as hour,\n    COUNT(*) as mention_count\n  FROM latest_steam_reviews\n  WHERE rn = 1\n  GROUP BY HOUR(FROM_UNIXTIME(timestamp_created))\n)\nSELECT \n  COALESCE(d.hour, s.hour) as hour,\n  COALESCE(d.mention_count, 0) + COALESCE(s.mention_count, 0) as total_mentions\nFROM discord_hourly d\nFULL OUTER JOIN steam_hourly s ON d.hour = s.hour\nORDER BY total_mentions DESC\nLIMIT 10;",
      "korean_question": "시간대별로 언급량이 가장 많은 시간은 언제인가요?",
      "source_file": "KPI_benchmark.md",
      "question_number": 5
    },
    {
      "id": "1d690e0ba7bc48c8b08eab2564adea51",
      "question": "How do positive/negative sentiment ratios differ between Discord and Steam?",
      "expected_sql": "WITH latest_reviews AS (\n  SELECT \n    r.voted_up,\n    ROW_NUMBER() OVER (PARTITION BY r.recommendationid ORDER BY r.event_date DESC) as rn\n  FROM sandbox.agent_poc.store_appreviews r\n  INNER JOIN sandbox.agent_poc.steam_apps s ON r.app_id = s.app_id\n  WHERE s.game_code = 'inzoi'\n    AND r.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n)\nSELECT \n  'Steam' as platform,\n  SUM(CASE WHEN voted_up = true THEN 1 ELSE 0 END) as positive_count,\n  SUM(CASE WHEN voted_up = false THEN 1 ELSE 0 END) as negative_count,\n  ROUND(SUM(CASE WHEN voted_up = true THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 2) as positive_percentage\nFROM latest_reviews\nWHERE rn = 1;",
      "korean_question": "디스코드와 스팀에서 긍정/부정 비율은 어떻게 다른가요?",
      "source_file": "KPI_benchmark.md",
      "question_number": 6
    },
    {
      "id": "4c74c26930a24a0a997a4260a117086a",
      "question": "Compare social reactions across different games",
      "expected_sql": "WITH discord_stats AS (\n  SELECT \n    m.game_code,\n    COUNT(DISTINCT m.message_id) as message_count,\n    COALESCE(SUM(r.count), 0) as reaction_count\n  FROM sandbox.agent_poc.message m\n  LEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\n  WHERE m.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n  GROUP BY m.game_code\n),\nlatest_reviews AS (\n  SELECT \n    s.game_code,\n    r.votes_up,\n    ROW_NUMBER() OVER (PARTITION BY r.recommendationid ORDER BY r.event_date DESC) as rn\n  FROM sandbox.agent_poc.store_appreviews r\n  INNER JOIN sandbox.agent_poc.steam_apps s ON r.app_id = s.app_id\n  WHERE r.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n),\nsteam_stats AS (\n  SELECT \n    game_code,\n    COUNT(*) as review_count,\n    SUM(votes_up) as total_upvotes\n  FROM latest_reviews\n  WHERE rn = 1\n  GROUP BY game_code\n)\nSELECT \n  COALESCE(d.game_code, s.game_code) as game_code,\n  COALESCE(d.message_count, 0) as discord_messages,\n  COALESCE(d.reaction_count, 0) as discord_reactions,\n  COALESCE(s.review_count, 0) as steam_reviews,\n  COALESCE(s.total_upvotes, 0) as steam_upvotes\nFROM discord_stats d\nFULL OUTER JOIN steam_stats s ON d.game_code = s.game_code\nORDER BY (COALESCE(d.message_count, 0) + COALESCE(s.review_count, 0)) DESC\nLIMIT 10;",
      "korean_question": "게임별로 소셜 반응을 비교해주세요",
      "source_file": "KPI_benchmark.md",
      "question_number": 7
    },
    {
      "id": "a759536d58df4f8b99055c0f909743ea",
      "question": "What is the daily social activity trend over the last 7 days?",
      "expected_sql": "WITH discord_daily AS (\n  SELECT \n    DATE(created_at) as activity_date,\n    COUNT(*) as message_count\n  FROM sandbox.agent_poc.message\n  WHERE game_code = 'inzoi'\n    AND event_date >= CURRENT_DATE - INTERVAL 7 DAYS\n  GROUP BY DATE(created_at)\n),\nlatest_reviews AS (\n  SELECT \n    r.timestamp_created,\n    ROW_NUMBER() OVER (PARTITION BY r.recommendationid ORDER BY r.event_date DESC) as rn\n  FROM sandbox.agent_poc.store_appreviews r\n  INNER JOIN sandbox.agent_poc.steam_apps s ON r.app_id = s.app_id\n  WHERE s.game_code = 'inzoi'\n    AND r.event_date >= CURRENT_DATE - INTERVAL 7 DAYS\n),\nsteam_daily AS (\n  SELECT \n    DATE(FROM_UNIXTIME(timestamp_created)) as activity_date,\n    COUNT(*) as review_count\n  FROM latest_reviews\n  WHERE rn = 1\n  GROUP BY DATE(FROM_UNIXTIME(timestamp_created))\n)\nSELECT \n  COALESCE(d.activity_date, s.activity_date) as date,\n  COALESCE(d.message_count, 0) as discord_messages,\n  COALESCE(s.review_count, 0) as steam_reviews,\n  COALESCE(d.message_count, 0) + COALESCE(s.review_count, 0) as total_activity\nFROM discord_daily d\nFULL OUTER JOIN steam_daily s ON d.activity_date = s.activity_date\nORDER BY date DESC;",
      "korean_question": "최근 7일간 일별 소셜 활동 추이는 어떻게 되나요?",
      "source_file": "KPI_benchmark.md",
      "question_number": 8
    },
    {
      "id": "46d98fb183eb42019c583f0489a9454f",
      "question": "What is the average recommendation score for Steam reviews?",
      "expected_sql": "WITH latest_reviews AS (\n  SELECT \n    s.game_code,\n    r.weighted_vote_score,\n    r.voted_up,\n    ROW_NUMBER() OVER (PARTITION BY r.recommendationid ORDER BY r.event_date DESC) as rn\n  FROM sandbox.agent_poc.store_appreviews r\n  INNER JOIN sandbox.agent_poc.steam_apps s ON r.app_id = s.app_id\n  WHERE s.game_code = 'inzoi'\n    AND r.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n)\nSELECT \n  game_code,\n  COUNT(*) as total_reviews,\n  AVG(CAST(weighted_vote_score AS DOUBLE)) as avg_weighted_score,\n  SUM(CASE WHEN voted_up = true THEN 1 ELSE 0 END) as positive_reviews,\n  SUM(CASE WHEN voted_up = false THEN 1 ELSE 0 END) as negative_reviews,\n  ROUND(SUM(CASE WHEN voted_up = true THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 2) as positive_rate\nFROM latest_reviews\nWHERE rn = 1\nGROUP BY game_code;",
      "korean_question": "스팀 리뷰의 평균 추천 점수는 얼마인가요?",
      "source_file": "KPI_benchmark.md",
      "question_number": 9
    },
    {
      "id": "1c814ae1d9a4423fa2b00a02c1e01599",
      "question": "What are the most frequently used emojis on Discord?",
      "expected_sql": "SELECT \n  r.emoji_name,\n  SUM(r.count) as total_usage,\n  COUNT(DISTINCT r.message_id) as unique_messages\nFROM sandbox.agent_poc.reaction r\nINNER JOIN sandbox.agent_poc.message m ON r.message_id = m.message_id\nWHERE m.game_code = 'inzoi'\n  AND m.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\nGROUP BY r.emoji_name\nORDER BY total_usage DESC\nLIMIT 10;",
      "korean_question": "디스코드에서 가장 많이 사용된 이모지는 무엇인가요?",
      "source_file": "KPI_benchmark.md",
      "question_number": 10
    },
    {
      "id": "cb6eb75c98d340d4a41720f25d2a6f86",
      "question": "What are the most discussed topics on Discord?",
      "expected_sql": "SELECT \n  c.channel_name,\n  COUNT(*) as message_count,\n  COUNT(DISTINCT m.author_id) as unique_authors,\n  MIN(m.created_at) as first_message,\n  MAX(m.created_at) as last_message\nFROM sandbox.agent_poc.message m\nINNER JOIN sandbox.agent_poc.channel_list c ON m.channel_id = c.channel_id\nWHERE m.game_code = 'inzoi'\n  AND m.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\nGROUP BY c.channel_name\nORDER BY message_count DESC\nLIMIT 10;",
      "korean_question": "디스코드에서 가장 많이 논의된 주제는 무엇인가요?",
      "source_file": "social_analytics_benchmark.md",
      "question_number": 1
    },
    {
      "id": "ae2ef6f5d8e1445d9ff7d0b272ed1a62",
      "question": "What keywords are frequently mentioned in Steam reviews?",
      "expected_sql": "WITH latest_reviews AS (\n  SELECT \n    r.recommendationid,\n    r.review,\n    r.voted_up,\n    r.votes_up,\n    r.timestamp_created,\n    ROW_NUMBER() OVER (PARTITION BY r.recommendationid ORDER BY r.event_date DESC) as rn\n  FROM sandbox.agent_poc.store_appreviews r\n  INNER JOIN sandbox.agent_poc.steam_apps s ON r.app_id = s.app_id\n  WHERE s.game_code = 'inzoi'\n    AND r.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n    AND LENGTH(r.review) > 100\n)\nSELECT \n  recommendationid,\n  review,\n  voted_up,\n  votes_up,\n  timestamp_created\nFROM latest_reviews\nWHERE rn = 1\nORDER BY votes_up DESC\nLIMIT 100;",
      "korean_question": "스팀 리뷰에서 자주 언급되는 키워드는 무엇인가요?",
      "source_file": "social_analytics_benchmark.md",
      "question_number": 2
    },
    {
      "id": "2a0e2232ba094171b1fe9f94d668e3e7",
      "question": "What are the most popular topic titles in Steam community?",
      "expected_sql": "WITH latest_topics AS (\n  SELECT \n    t.url,\n    t.title,\n    t.author,\n    t.timestamp,\n    ROW_NUMBER() OVER (PARTITION BY t.url ORDER BY t.event_date DESC) as rn\n  FROM sandbox.agent_poc.community_discussions_topics t\n  INNER JOIN sandbox.agent_poc.steam_apps s ON t.app_id = s.app_id\n  WHERE s.game_code = 'inzoi'\n    AND t.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n),\nlatest_comments AS (\n  SELECT \n    c.topic_url,\n    c.comment_id,\n    ROW_NUMBER() OVER (PARTITION BY c.comment_id ORDER BY c.event_date DESC) as rn\n  FROM sandbox.agent_poc.community_discussions_comments c\n  WHERE c.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n)\nSELECT \n  t.title,\n  t.author,\n  t.timestamp as created_at,\n  COUNT(DISTINCT c.comment_id) as comment_count,\n  t.url\nFROM latest_topics t\nLEFT JOIN latest_comments c ON t.url = c.topic_url AND c.rn = 1\nWHERE t.rn = 1\nGROUP BY t.title, t.author, t.timestamp, t.url\nORDER BY comment_count DESC\nLIMIT 10;",
      "korean_question": "스팀 커뮤니티에서 가장 인기 있는 토픽 제목은 무엇인가요?",
      "source_file": "social_analytics_benchmark.md",
      "question_number": 3
    },
    {
      "id": "5e816f20fb4d4fb8b3400a88a38e20f8",
      "question": "What are the main conversation topics in a specific Discord channel?",
      "expected_sql": "SELECT \n  m.message_id,\n  m.message as content,\n  m.author_id,\n  m.created_at,\n  COALESCE(SUM(r.count), 0) as reaction_count\nFROM sandbox.agent_poc.message m\nINNER JOIN sandbox.agent_poc.channel_list c ON m.channel_id = c.channel_id\nLEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\nWHERE m.game_code = 'inzoi'\n  AND c.channel_name = 'inzoi-chat'\n  AND m.event_date >= CURRENT_DATE - INTERVAL 7 DAYS\nGROUP BY m.message_id, m.message, m.author_id, m.created_at\nORDER BY reaction_count DESC, m.created_at DESC\nLIMIT 50;",
      "korean_question": "디스코드에서 특정 채널의 주요 대화 내용은 무엇인가요?",
      "source_file": "social_analytics_benchmark.md",
      "question_number": 4
    },
    {
      "id": "e4c05539bf514349b21966bfefc7c408",
      "question": "What are the main points in positive Steam reviews?",
      "expected_sql": "WITH latest_reviews AS (\n  SELECT \n    r.recommendationid,\n    r.review,\n    r.votes_up,\n    r.weighted_vote_score,\n    r.timestamp_created,\n    r.author.steamid as author_steamid,\n    ROW_NUMBER() OVER (PARTITION BY r.recommendationid ORDER BY r.event_date DESC) as rn\n  FROM sandbox.agent_poc.store_appreviews r\n  INNER JOIN sandbox.agent_poc.steam_apps s ON r.app_id = s.app_id\n  WHERE s.game_code = 'inzoi'\n    AND r.voted_up = true\n    AND r.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n    AND LENGTH(r.review) > 200\n)\nSELECT \n  recommendationid,\n  review,\n  votes_up,\n  weighted_vote_score,\n  timestamp_created,\n  author_steamid\nFROM latest_reviews\nWHERE rn = 1\nORDER BY votes_up DESC\nLIMIT 50;",
      "korean_question": "스팀 리뷰에서 긍정적인 리뷰의 주요 내용은 무엇인가요?",
      "source_file": "social_analytics_benchmark.md",
      "question_number": 5
    },
    {
      "id": "6dc0faeabf39408a9ae88c2768687128",
      "question": "What are the main complaints in negative Steam reviews?",
      "expected_sql": "WITH latest_reviews AS (\n  SELECT \n    r.recommendationid,\n    r.review,\n    r.votes_up,\n    r.weighted_vote_score,\n    r.timestamp_created,\n    r.author.steamid as author_steamid,\n    ROW_NUMBER() OVER (PARTITION BY r.recommendationid ORDER BY r.event_date DESC) as rn\n  FROM sandbox.agent_poc.store_appreviews r\n  INNER JOIN sandbox.agent_poc.steam_apps s ON r.app_id = s.app_id\n  WHERE s.game_code = 'inzoi'\n    AND r.voted_up = false\n    AND r.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n    AND LENGTH(r.review) > 200\n)\nSELECT \n  recommendationid,\n  review,\n  votes_up,\n  weighted_vote_score,\n  timestamp_created,\n  author_steamid\nFROM latest_reviews\nWHERE rn = 1\nORDER BY votes_up DESC\nLIMIT 50;",
      "korean_question": "스팀 리뷰에서 부정적인 리뷰의 주요 불만사항은 무엇인가요?",
      "source_file": "social_analytics_benchmark.md",
      "question_number": 6
    },
    {
      "id": "270ca05c37a54d5a9a8f052c8bee5368",
      "question": "What are the recent announcements in Discord announcement channels?",
      "expected_sql": "SELECT \n  m.message_id,\n  m.message as content,\n  m.created_at,\n  c.channel_name,\n  COALESCE(SUM(r.count), 0) as reaction_count\nFROM sandbox.agent_poc.message m\nINNER JOIN sandbox.agent_poc.channel_list c ON m.channel_id = c.channel_id\nLEFT JOIN sandbox.agent_poc.reaction r ON m.message_id = r.message_id\nWHERE m.game_code = 'inzoi'\n  AND c.channel_name IN ('announcements', 'service-notice')\n  AND m.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\nGROUP BY m.message_id, m.message, m.created_at, c.channel_name\nORDER BY m.created_at DESC\nLIMIT 20;",
      "korean_question": "디스코드에서 공지사항 채널의 최근 내용은 무엇인가요?",
      "source_file": "social_analytics_benchmark.md",
      "question_number": 7
    },
    {
      "id": "a3a9d699627a45028b18f218cad40811",
      "question": "What are the comments on a specific Steam community topic?",
      "expected_sql": "WITH latest_topics AS (\n  SELECT \n    t.url,\n    t.title,\n    ROW_NUMBER() OVER (PARTITION BY t.url ORDER BY t.event_date DESC) as rn\n  FROM sandbox.agent_poc.community_discussions_topics t\n  INNER JOIN sandbox.agent_poc.steam_apps s ON t.app_id = s.app_id\n  WHERE s.game_code = 'inzoi'\n    AND t.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n    AND t.title LIKE '%building%'\n),\nlatest_comments AS (\n  SELECT \n    c.topic_url,\n    c.comment_id,\n    c.author,\n    c.content,\n    c.timestamp,\n    ROW_NUMBER() OVER (PARTITION BY c.comment_id ORDER BY c.event_date DESC) as rn\n  FROM sandbox.agent_poc.community_discussions_comments c\n  WHERE c.event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n)\nSELECT \n  t.title as topic_title,\n  c.comment_id,\n  c.author,\n  c.content,\n  c.timestamp as created_at\nFROM latest_topics t\nINNER JOIN latest_comments c ON t.url = c.topic_url AND c.rn = 1\nWHERE t.rn = 1\nORDER BY c.timestamp ASC\nLIMIT 100;",
      "korean_question": "스팀 커뮤니티에서 특정 토픽의 댓글 내용은 무엇인가요?",
      "source_file": "social_analytics_benchmark.md",
      "question_number": 8
    },
    {
      "id": "ac7cdc3f1ea7447093c69c741e2c2581",
      "question": "Who are the most active users on Discord?",
      "expected_sql": "WITH user_messages AS (\n  SELECT \n    author_id,\n    COUNT(*) as message_count\n  FROM sandbox.agent_poc.message\n  WHERE game_code = 'inzoi'\n    AND event_date >= CURRENT_DATE - INTERVAL 30 DAYS\n  GROUP BY author_id\n)\nSELECT \n  author_id as user_id,\n  message_count as messages,\n  0 as reactions,\n  message_count as activity_score\nFROM user_messages\nORDER BY activity_score DESC\nLIMIT 20;",
      "korean_question": "디스코드에서 가장 활발한 사용자는 누구인가요?",
      "source_file": "social_analytics_benchmark.md",
      "question_number": 9
    },
    {
      "id": "fa9cd50161314213add7c374e60ccc2b",
      "question": "What are the most discussed issues in the last week across platforms?",
      "expected_sql": "WITH discord_topics AS (\n  SELECT \n    'Discord' as platform,\n    c.channel_name as topic,\n    COUNT(*) as mention_count\n  FROM sandbox.agent_poc.message m\n  INNER JOIN sandbox.agent_poc.channel_list c ON m.channel_id = c.channel_id\n  WHERE m.game_code = 'inzoi'\n    AND m.event_date >= CURRENT_DATE - INTERVAL 7 DAYS\n  GROUP BY c.channel_name\n),\nlatest_topics AS (\n  SELECT \n    t.title,\n    t.url,\n    ROW_NUMBER() OVER (PARTITION BY t.url ORDER BY t.event_date DESC) as rn\n  FROM sandbox.agent_poc.community_discussions_topics t\n  INNER JOIN sandbox.agent_poc.steam_apps s ON t.app_id = s.app_id\n  WHERE s.game_code = 'inzoi'\n    AND t.event_date >= CURRENT_DATE - INTERVAL 7 DAYS\n),\nlatest_comments AS (\n  SELECT \n    c.topic_url,\n    c.comment_id,\n    ROW_NUMBER() OVER (PARTITION BY c.comment_id ORDER BY c.event_date DESC) as rn\n  FROM sandbox.agent_poc.community_discussions_comments c\n  WHERE c.event_date >= CURRENT_DATE - INTERVAL 7 DAYS\n),\nsteam_topics AS (\n  SELECT \n    'Steam Community' as platform,\n    t.title as topic,\n    COUNT(DISTINCT c.comment_id) as mention_count\n  FROM latest_topics t\n  LEFT JOIN latest_comments c ON t.url = c.topic_url AND c.rn = 1\n  WHERE t.rn = 1\n  GROUP BY t.title\n)\nSELECT platform, topic, mention_count\nFROM (\n  SELECT * FROM discord_topics\n  UNION ALL\n  SELECT * FROM steam_topics\n) combined\nORDER BY mention_count DESC\nLIMIT 20;",
      "korean_question": "최근 일주일간 가장 많이 논의된 이슈는 무엇인가요?",
      "source_file": "social_analytics_benchmark.md",
      "question_number": 10
    }
  ],
  "metadata": {
    "total_count": 20,
    "source_files": [
      "social_analytics_benchmark.md",
      "KPI_benchmark.md"
    ]
  }
}